import{s as H}from"./x_rD_Ya3.js";import{r as x,g as k,n as S,k as j,q as K,c as g,o as y,a as f,J as U,aB as I,F as R,B as $,t as w,M as q,a1 as G,I as J,d as Z}from"./BnZsyVnb.js";const Q={class:"bg-white/25 backdrop-blur-xl border border-white/40 shadow-[0_8px_32px_0_rgba(31,38,135,0.15)] rounded-[3rem] p-8 md:p-12 w-full max-w-lg flex flex-col items-center text-center relative"},W={class:"mb-10 relative"},X={class:"flex gap-4 mb-8",dir:"ltr"},Y=["value","onInput","onKeydown","onPaste"],ee={key:0,class:"text-[#5D4037] mb-8 font-medium"},te=["disabled"],le={class:"mt-8 text-[#5D4037] text-sm font-medium"},oe=["disabled"],re={__name:"OtpCard",props:{modelValue:{type:String,default:""},length:{type:Number,default:4},initialTime:{type:Number,default:59},showTimer:{type:Boolean,default:!0},confirmText:{type:String,default:"تأكيد"},resendText:{type:String,default:"إعادة الإرسال"},resendPrefixText:{type:String,default:"لم تستلم الرمز؟"},autoFocus:{type:Boolean,default:!0},numericOnly:{type:Boolean,default:!0},disableConfirmUntilComplete:{type:Boolean,default:!0}},emits:["update:modelValue","confirm","resend","expired"],setup(d,{expose:V,emit:D}){const l=d,h=D,C=x([]),r=x(Array.from({length:l.length},()=>"")),i=x(l.initialTime);let m=null;const p=k(()=>r.value.join("")),A=k(()=>r.value.every(e=>String(e||"").length===1)),F=k(()=>l.disableConfirmUntilComplete&&!A.value),s=async e=>{var o;await G();const t=(o=C.value)==null?void 0:o[e];t!=null&&t.focus&&t.focus()},_=e=>{const t=String(e??""),n=(l.numericOnly?t.replace(/[^0-9]/g,""):t).split("").slice(0,l.length);r.value=Array.from({length:l.length},(a,c)=>n[c]??"")};S(()=>l.modelValue,e=>{String(e??"")!==p.value&&_(e)},{immediate:!0}),S(()=>l.length,()=>z());const v=()=>{h("update:modelValue",p.value)},L=(e,t)=>{var c;const o=String(((c=e==null?void 0:e.target)==null?void 0:c.value)??""),a=(l.numericOnly?o.replace(/[^0-9]/g,""):o).slice(-1);r.value[t]=a,v(),a&&t<l.length-1&&s(t+1)},M=(e,t)=>{const o=e==null?void 0:e.key;if(o==="Backspace"){if(!r.value[t]&&t>0){s(t-1);return}r.value[t]="",v();return}o==="ArrowLeft"&&t>0?s(t-1):o==="ArrowRight"&&t<l.length-1&&s(t+1)},N=(e,t)=>{var T;const o=String(((T=e==null?void 0:e.clipboardData)==null?void 0:T.getData("text"))??"");if(!o)return;const n=l.numericOnly?o.replace(/[^0-9]/g,""):o;if(!n)return;e.preventDefault();const a=n.split("");for(let u=0;u<a.length;u++){const B=t+u;if(B>=l.length)break;r.value[B]=a[u]}v();const c=r.value.findIndex(u=>!u);s(c===-1?l.length-1:c)},b=({keepTimer:e=!1}={})=>{r.value=Array.from({length:l.length},()=>""),v(),e||(i.value=l.initialTime),l.autoFocus&&s(0)},E=()=>{b({keepTimer:!1}),h("resend")},O=()=>{h("confirm",p.value)},P=()=>{m&&clearInterval(m),m=H(()=>{i.value>0&&(i.value-=1,i.value===0&&h("expired"))},1e3)},z=()=>{_(p.value),b({keepTimer:!0})};return j(()=>{P(),l.autoFocus&&s(0)}),K(()=>{m&&clearInterval(m)}),V({focus:()=>s(0),reset:b}),(e,t)=>(y(),g("div",Q,[f("div",W,[I(e.$slots,"illustration",{},()=>[t[0]||(t[0]=J('<div class="relative w-32 h-32 flex items-center justify-center"><svg viewBox="0 0 24 24" fill="none" class="w-24 h-24 text-black drop-shadow-md" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" fill="#A7D4E6" fill-opacity="0.5"></path><polyline points="22,6 12,13 2,6"></polyline></svg><div class="absolute top-0 right-0 transform translate-x-2 -translate-y-2"><svg width="50" height="40" viewBox="0 0 50 40" fill="none"><path d="M45 0H5C2.23858 0 0 2.23858 0 5V25C0 27.7614 2.23858 30 5 30H15L10 40L25 30H45C47.7614 30 50 27.7614 50 25V5C50 2.23858 47.7614 0 45 0Z" fill="#F97316"></path><circle cx="12" cy="15" r="2" fill="white" opacity="0.8"></circle><circle cx="25" cy="15" r="2" fill="white" opacity="0.8"></circle><circle cx="38" cy="15" r="2" fill="white" opacity="0.8"></circle></svg></div><div class="absolute bottom-2 left-0 transform -translate-x-2 translate-y-2 bg-[#2ECC71] rounded-full p-1.5 shadow-lg border-2 border-white"><svg width="16" height="16" viewBox="0 0 24 24" stroke="white" stroke-width="4" fill="none"><polyline points="20 6 9 17 4 12"></polyline></svg></div></div>',1))])]),f("div",X,[(y(!0),g(R,null,$(d.length,(o,n)=>(y(),g("input",{key:n,ref_for:!0,ref_key:"otpInputs",ref:C,inputmode:"numeric",type:"text",maxlength:"1",autocomplete:"one-time-code",value:r.value[n],onInput:a=>L(a,n),onKeydown:a=>M(a,n),onPaste:a=>N(a,n),class:"w-14 h-14 md:w-16 md:h-16 rounded-xl bg-white/40 border border-white/50 text-center text-2xl font-bold text-[#5D4037] focus:outline-none focus:ring-2 focus:ring-[#C1582D]/50 focus:bg-white/60 transition-all shadow-inner"},null,40,Y))),128))]),d.showTimer?(y(),g("div",ee,[I(e.$slots,"timer",{timeLeft:i.value},()=>[Z(" الوقت المتبقي : "+w(i.value)+" ثانية ",1)])])):U("",!0),f("button",{type:"button",disabled:F.value,class:"w-40 py-3 rounded-2xl bg-gradient-to-r from-[#A04018] to-[#C85C2E] text-white font-bold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-lg disabled:hover:-translate-y-0",onClick:O},w(d.confirmText),9,te),f("div",le,[f("span",null,w(d.resendPrefixText),1),f("button",{type:"button",onClick:E,disabled:i.value>0,class:q(i.value>0?"opacity-50 cursor-not-allowed":"text-[#A04018] font-bold hover:text-[#803010]")},w(d.resendText),11,oe)])]))}};export{re as _};
