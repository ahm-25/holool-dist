import{_ as V}from"./CCtwN-yS.js";import{_ as I,C as S,P as W}from"./DUhHHiqv.js";import{_ as O}from"./qXBOsRPR.js";import{_ as z}from"./CSO7IP8C.js";import{b as G}from"./NVE8NEWq.js";import{G as H,a5 as J,W as Y,n as w,c as l,a as s,b as p,C as m,d as E,t as o,J as K,F as N,B as T,w as Q,r as q,m as c,o as d}from"./CtGyamCA.js";import"./B3LWhJXf.js";import"./C2TBslFw.js";import"./DIH-4xJn.js";const X={class:"min-h-screen pb-20 overflow-x-hidden relative"},Z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ee={key:0,class:"mt-6 p-4 rounded-2xl bg-red-50/80 border border-red-200 text-red-700"},te={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-6"},ae={class:"w-full mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 fade-in"},se={class:"flex justify-between items-start mb-4"},ne={class:"flex flex-col items-start gap-1"},oe={class:"text-[#8b7e77] text-sm"},re={class:"text-[#5d5551] font-bold text-lg"},ie={class:"flex items-start gap-3"},le={class:"flex flex-col items-end"},ce={class:"font-bold text-[#5d5551] text-lg"},de={class:"flex items-center gap-1 text-[#9ca3af] text-xs mt-0.5"},ue={class:"w-10 h-10 rounded-lg border border-[#bf4e26]/30 flex items-center justify-center text-[#bf4e26] bg-[#bf4e26]/10"},pe={class:"flex justify-between items-end mt-2 pt-3 border-t border-[#bf4e26]/10"},me={class:"flex flex-col gap-1"},_e={class:"text-[#8b7e77] text-xs"},ge={class:"font-bold text-[#5d5551]"},fe={key:1,class:"col-span-full flex flex-col items-center justify-center py-20 text-[#8b7e77] opacity-60"},be={class:"text-lg font-medium"},ve={class:"mt-4 text-xs text-[#8b7e77] opacity-70"},Ce={__name:"index",async setup(xe){let g,k;const f=q("NEW"),r=q(1),$=H(),v=c(()=>({NEW:"new",PAYMENT:"waiting_for_pay",CURRENT:"current",FINISHED:"finished"})[f.value]||"new"),b=J(),D=c(()=>({status:v.value,page:r.value,tab:b.query.tab||"sent"})),L=c(()=>`orders-maintenance-${v.value}-${r.value}-${b.query.tab||"sent"}`),{data:B,pending:P,error:M,refresh:A}=([g,k]=Y(()=>G("/orders/maintenance",{query:D,watch:[v,r],server:!1,key:L})),g=await g,k(),g),j=c(()=>{const e=B.value;if(!e||typeof e!="object")return e;const n=e,i=n?.data&&typeof n.data=="object"?n.data:n,a=i?.data&&typeof i.data=="object"?i.data:i,u=a?.pagination??i?.pagination??n?.pagination;return u&&a&&typeof a=="object"&&!Array.isArray(a)&&!a.pagination?{...a,pagination:u}:a}),C=c(()=>{const e=j.value;return Array.isArray(e?.orders)&&e.orders||Array.isArray(e?.data?.orders)&&e.data.orders||Array.isArray(e)&&e||[]}),x=c(()=>{const e=j.value,n=u=>{if(!u||typeof u!="string")return null;try{const _=new URL(u).searchParams.get("page"),y=Number(_);return Number.isFinite(y)&&y>0?y:null}catch{const h=u.match(/[?&]page=(\d+)/);if(!h)return null;const _=Number(h[1]);return Number.isFinite(_)&&_>0?_:null}},i=e?.pagination?.total_pages??e?.pagination?.totalPages??e?.total_pages??e?.last_page??e?.meta?.last_page??e?.pagination?.last_page??e?.data?.last_page??(e?.total&&e?.per_page?Math.ceil(Number(e.total)/Number(e.per_page)):null)??(e?.pagination?.total_items&&e?.pagination?.per_page?Math.ceil(Number(e.pagination.total_items)/Number(e.pagination.per_page)):null)??n(e?.last_page_url)??n(e?.pagination?.next_page_url)??1,a=Number(i);return Number.isFinite(a)&&a>0?a:1}),F=c(()=>M.value?t("profile.orders.maintenance.loadError"):null),R=c(()=>P.value);w(()=>b.query.tab,()=>{A()}),w(f,()=>{r.value=1}),w([x,P],([e,n])=>{n||(r.value>e&&(r.value=e||1),r.value<1&&(r.value=1))});const U=e=>{f.value=e};return(e,n)=>{const i=V;return d(),l("div",X,[s("div",Z,[p(z,{items:[{label:e.$t("profile.orders.title"),to:m($)("/profile/orders"),active:!1},{label:e.$t("profile.orders.menuItems.maintenance.title"),active:!0}]},null,8,["items"]),p(I,{"active-tab":f.value,onChange:U},null,8,["active-tab"]),F.value?(d(),l("div",ee,[E(o(F.value)+" ",1),s("button",{class:"underline font-semibold ms-2",onClick:n[0]||(n[0]=a=>m(A)())},o(e.$t("cards.maintenanceDetails.retry")),1)])):K("",!0),R.value?(d(),l("div",te,[(d(),l(N,null,T(6,a=>s("div",{key:a,class:"animate-pulse rounded-2xl bg-white/40 h-[150px]"})),64))])):(d(),l(N,{key:2},[s("div",ae,[C.value.length?(d(!0),l(N,{key:0},T(C.value,a=>(d(),l("div",{key:a.id??a.order_num,class:"group bg-white/40 backdrop-blur-sm border border-white/60 rounded-2xl p-5 shadow-sm hover:shadow-md hover:bg-white/60 transition-all duration-300 flex flex-col justify-between min-h-[140px]"},[s("div",se,[s("div",ne,[s("span",oe,o(e.$t("cards.maintenanceDetails.serviceType"))+" :",1),s("span",re,o(a.type_text??a.serviceType??"-"),1)]),s("div",ie,[s("div",le,[s("span",ce,o(a.order_num??a.id),1),s("div",de,[p(m(S),{class:"w-3 h-3"}),s("span",null,o(a.created_at??a.time??""),1)])]),s("div",ue,[p(m(W),{class:"w-5 h-5"})])])]),s("div",pe,[s("div",me,[s("span",_e,o(e.$t("cards.maintenanceDetails.status"))+" :",1),s("span",ge,o(a.status_text??a.status??""),1)]),p(i,{to:m($)({path:`/profile/orders/maintenance/${a.id}`,query:{tab:m(b).query.tab||"sent"}}),class:"text-primary font-bold text-sm hover:underline"},{default:Q(()=>[E(o(e.$t("common.viewOrder")),1)]),_:1},8,["to"])])]))),128)):(d(),l("div",fe,[n[2]||(n[2]=s("div",{class:"w-16 h-16 mb-4 rounded-full border-2 border-dashed border-[#8b7e77] flex items-center justify-center"},[s("span",{class:"text-2xl"},"!")],-1)),s("p",be,o(e.$t("profile.orders.noOrders")),1)]))]),s("div",ve," page: "+o(r.value)+" / totalPages: "+o(x.value),1),p(O,{page:r.value,"onUpdate:page":n[1]||(n[1]=a=>r.value=a),"total-pages":x.value},null,8,["page","total-pages"])],64))])])}}};export{Ce as default};
