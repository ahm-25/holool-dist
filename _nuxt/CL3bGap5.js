import{_ as L}from"./GzQTdmL6.js";import{b as u,c as j,u as D,F as p,E as f}from"./BaUCWVHf.js";import{E as I,K as N,H as T,G as U,r as S,k as $,c as h,a,b as s,C as o,w as x,T as g,F as G,B as H,t as k,o as v}from"./DtlkFUv2.js";import{a as K}from"./BcraiT0z.js";import{u as O}from"./qIaXEmvY.js";import{U as R,M as J,B as Q}from"./BSi6AD8o.js";import{C as W}from"./Dg_5oGkL.js";import"./CbXOsLjH.js";import"./B6LoSh53.js";import"./B8u25cvq.js";import"./CY06FC8a.js";const X={class:"min-h-screen w-full bg-gradient-to-br from-[#ede5e2] via-[#dcc3ba] to-[#c59a89] relative flex items-center justify-center p-4 overflow-hidden"},Y={class:"absolute top-4 right-4 md:top-8 md:right-8 z-10"},Z={class:"[&_nav]:!mb-0"},ee={class:"w-full max-w-2xl z-10"},te={class:"w-full backdrop-blur-xl bg-white/30 border border-white/40 rounded-[2rem] shadow-xl overflow-hidden p-6 md:p-10 lg:p-12 animate-fade-in-up"},ae={class:"relative group mt-2"},re={class:"relative group mt-2"},oe={class:"relative group mt-2"},se=["value"],ie={class:"pt-4 flex justify-center"},le=["disabled"],ye={__name:"change-profile",setup(ne){const B=[{label:"الإعدادات",to:"/profile/more/settings",active:!1},{label:"تعديل الملف الشخصي",to:"/profile/more/settings/change-profile",active:!0}],{t:d}=I(),i=N(),{get:F}=K(),m=O(),z=T(),E=U(),c=S(!1),M=u().trim().required(d("validation.required")).min(3,d("validation.min",{min:3})).max(50,d("validation.max",{max:50})).label("الاسم"),P=u().trim().nullable().transform(e=>e===""||!e?null:e).test("email-format",d("validation.email"),function(e){return!e||e.length===0?!0:u().email().isValidSync(e)}).label(d("auth.email")),V=u().required(d("validation.required")).label("المدينة"),C=j({name:M,email:P,city_id:V}),{handleSubmit:q,resetForm:_,setValues:de,values:ce}=D({validationSchema:C,initialValues:{name:"",email:"",city_id:""}}),w=S([]),A=async()=>{try{const e=await F("/cities");e!=null&&e.data&&(w.value=e.data)}catch(e){console.error("Error fetching cities:",e)}};$(async()=>{var e,t;i.initAuth(),await A(),c.value=!0;try{const r=await i.getProfile();r.success&&r.data?(console.log("Profile data loaded:",r.data),_({values:{name:r.data.name||"",email:r.data.email||"",city_id:((e=r.data.city)==null?void 0:e.id)||r.data.city_id||""}})):(console.error("Failed to load profile:",r.error),i.user&&_({values:{name:i.user.name||"",email:i.user.email||"",city_id:((t=i.user.city)==null?void 0:t.id)||i.user.city_id||""}}))}catch(r){console.error("Error in onMounted profile fetch:",r)}finally{c.value=!1}});const y=q(async e=>{c.value=!0;try{const t=await i.updateProfile({name:e.name,email:e.email,city_id:e.city_id});t.success?(m.success(t.message||"تم تحديث الملف الشخصي بنجاح"),z.push(E("/profile/more/settings"))):m.error(t.error||"فشل تحديث الملف الشخصي")}catch{m.error("حدث خطأ أثناء تحديث الملف الشخصي")}finally{c.value=!1}});return(e,t)=>{const r=L;return v(),h("div",X,[t[5]||(t[5]=a("div",{class:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-white/10 rounded-full blur-[100px]"},null,-1)),t[6]||(t[6]=a("div",{class:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-[#a04824]/20 rounded-full blur-[100px]"},null,-1)),a("div",Y,[a("div",Z,[s(r,{items:B,direction:"rtl"})])]),a("main",ee,[a("div",te,[a("form",{onSubmit:t[0]||(t[0]=(...n)=>o(y)&&o(y)(...n)),class:"flex flex-col gap-6 md:gap-8"},[a("div",null,[t[1]||(t[1]=a("label",{class:"text-[#5e4b44] font-bold text-sm md:text-base pr-1"},"اسم المستخدم",-1)),a("div",ae,[s(o(p),{name:"name"},{default:x(({field:n,meta:l})=>[a("input",g(n,{type:"text",placeholder:"اسم المستخدم",class:["w-full bg-white/40 border-2 rounded-xl py-3 pr-10 pl-4 text-right","text-[#5e4b44] placeholder-[#8c6b5d] outline-none transition-all",l.touched&&l.invalid?"border-red-500/50 focus:bg-white/60 focus:border-red-500/70":"border-transparent focus:bg-white/60 focus:border-[#a04824]/30 hover:bg-white/50"]}),null,16)]),_:1}),s(o(R),{size:"20",class:"absolute right-3 top-1/2 -translate-y-1/2 text-[#8c6b5d]"})]),s(o(f),{name:"name",class:"text-red-500 text-xs pr-1 mt-1 block text-right"})]),a("div",null,[t[2]||(t[2]=a("label",{class:"text-[#5e4b44] font-bold text-sm md:text-base pr-1"}," البريد الإلكتروني (اختياري) ",-1)),a("div",re,[s(o(p),{name:"email"},{default:x(({field:n,meta:l})=>[a("input",g(n,{type:"email",placeholder:"البريد الإلكتروني",class:["w-full bg-white/40 border-2 rounded-xl py-3 pr-10 pl-4 text-right","text-[#5e4b44] placeholder-[#8c6b5d] outline-none transition-all",l.touched&&l.invalid?"border-red-500/50 focus:bg-white/60 focus:border-red-500/70":"border-transparent focus:bg-white/60 focus:border-[#a04824]/30 hover:bg-white/50"]}),null,16)]),_:1}),s(o(J),{size:"20",class:"absolute right-3 top-1/2 -translate-y-1/2 text-[#8c6b5d]"})]),s(o(f),{name:"email",class:"text-red-500 text-xs pr-1 mt-1 block text-right"})]),a("div",null,[t[4]||(t[4]=a("label",{class:"text-[#5e4b44] font-bold text-sm md:text-base pr-1"},"المدينة",-1)),a("div",oe,[s(o(p),{name:"city_id"},{default:x(({field:n,meta:l})=>[a("select",g(n,{class:["w-full bg-white/40 border-2 rounded-xl py-3 pr-10 pl-10 text-right appearance-none cursor-pointer outline-none transition-all","text-[#5e4b44]",l.touched&&l.invalid?"border-red-500/50 focus:bg-white/60 focus:border-red-500/70":"border-transparent focus:bg-white/60 focus:border-[#a04824]/30 hover:bg-white/50"],dir:"rtl"}),[t[3]||(t[3]=a("option",{disabled:"",value:""},"المدينة",-1)),(v(!0),h(G,null,H(w.value,b=>(v(),h("option",{class:"text-[#5e4b44] bg-[#f5f0ee]",key:b.id,value:b.id},k(b.name),9,se))),128))],16)]),_:1}),s(o(Q),{size:"20",class:"absolute right-3 top-1/2 -translate-y-1/2 text-[#8c6b5d]"}),s(o(W),{size:"18",class:"absolute left-3 top-1/2 -translate-y-1/2 text-[#8c6b5d]"})]),s(o(f),{name:"city_id",class:"text-red-500 text-xs pr-1 mt-1 block text-right"})]),a("div",ie,[a("button",{type:"submit",disabled:c.value,class:"bg-gradient-to-l from-[#943d1b] to-[#c65d33] text-white font-bold text-lg py-3 px-12 rounded-xl shadow-[0_4px_14px_rgba(160,72,36,0.4)] hover:-translate-y-0.5 hover:shadow-[0_6px_20px_rgba(160,72,36,0.6)] transition-all duration-300 w-full md:w-auto md:min-w-[180px] disabled:opacity-50"},k(c.value?"جاري الحفظ...":"تعديل"),9,le)])],32)])])])}}};export{ye as default};
