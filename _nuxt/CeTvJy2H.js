import{_ as Z}from"./D_ZRKmKf.js";import{_ as K}from"./CWwx7GjC.js";import{a5 as O,H as W,G as X,E as ee,a0 as te,u as se,c as i,a as s,b as p,C as e,S as oe,t as n,P as m,Q as v,T as g,Y as h,J as b,Z as re,F as ae,B as ne,d as le,r as P,m as ie,o as d}from"./OHovtJ2W.js";import{c as de,b as _,g as ce,u as ue}from"./BZZvMDEt.js";import{u as pe}from"./BNTIH_c1.js";import{a as me}from"./Bq1w4Z7W.js";import{C as ge}from"./DnTeSXwe.js";import{P as he}from"./DXsp30zX.js";import{L as be}from"./C7adT7Mk.js";import"./CO_oDcuT.js";import"./93K8yIaP.js";import"./4Hd1qslu.js";import"./DKtB3zr-.js";import"./DOAsI3H4.js";const fe={class:"min-h-screen bg-gradient-to-br from-[#e8d5cc] to-[#dcb8a8] py-8 px-4 flex flex-col"},ve={class:"container mx-auto"},_e={class:"flex-1 flex items-center justify-center"},ye={class:"bg-white/30 backdrop-blur-md rounded-[3rem] p-8 w-full max-w-2xl shadow-xl border border-white/40"},xe={class:"space-y-2"},qe={class:"block text-right text-[#5d4037] font-bold pr-2"},ke=["placeholder"],we={key:0,class:"text-red-600 text-sm block text-right pr-2"},Re={class:"space-y-2"},$e={class:"block text-right text-[#5d4037] font-bold pr-2"},Pe={class:"relative"},Ee={value:"",disabled:"",selected:""},De=["value"],Ae={class:"absolute left-4 top-1/2 -translate-y-1/2 pointer-events-none text-gray-500"},Ce={key:0,class:"text-red-600 text-sm block text-right pr-2"},Fe={class:"space-y-2"},Be={class:"block text-right text-[#5d4037] font-bold pr-2"},Le=["placeholder"],Se={key:0,class:"text-red-600 text-sm block text-right pr-2"},Ve={class:"space-y-2"},Me={class:"block text-right text-[#5d4037] font-bold pr-2"},Ne=["placeholder"],Ue={class:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none"},ze={class:"border border-gray-500 rounded-full p-0.5"},Ie={key:0,class:"text-red-600 text-sm block text-right pr-2"},Te={class:"space-y-2"},je={class:"block text-right text-[#5d4037] font-bold pr-2"},He=["placeholder"],Qe={key:0,class:"text-red-600 text-sm block text-right pr-2"},Ge={class:"pt-4"},Je=["disabled"],Ye={key:0},Ze={key:1,class:"flex items-center justify-center gap-2"},ut={__name:"request",setup(Ke){const F=O(),B=W(),y=X(),{t:l}=ee(),{success:L,error:E}=pe(),D=F.query.id,S=de({rentPeriod:_().required(l("validation.required")).matches(/^[0-9]+$/,l("validation.numbers_only")||"الأرقام فقط مسموح بها"),quantity:ce().required(l("validation.required")),startDate:_().required(l("validation.required")),location:_().required(l("validation.required")),notes:_().nullable()}),V=ie(()=>[{label:l("navigation.home"),to:y("/"),active:!1},{label:l("categories.medicalRental.title"),to:y("/profile/sections/medical-rent"),active:!1},{label:l("categories.medicalRent.request.title"),to:"",active:!0}]),{handleSubmit:M,errors:a,isSubmitting:A,defineField:c,setFieldValue:N,resetForm:U}=ue({validationSchema:S});te(()=>{U({values:{rentPeriod:"",quantity:"",startDate:"",location:"",notes:""}}),u.value=!1,R.value=null,$.value=null});const[f,z]=c("rentPeriod"),[x,I]=c("quantity"),[q,T]=c("startDate"),[k,j]=c("location"),[w,H]=c("notes"),u=P(!1),R=P(null),$=P(null),Q=o=>{N("location",o.address),R.value=o.lat,$.value=o.lng,u.value=!1},{post:G}=me(),C=M(async o=>{if(!D){E(l("categories.medicalRent.request.deviceNotFound"));return}try{const t=await G("/orders/create-rent-order",null,{query:{machine_id:D,rent_period:o.rentPeriod,quantity:o.quantity,lat:R.value,lng:$.value,map_desc:o.location,notes:o.notes||""}});if(t?.key==="success"||t?.status===200||t?.success)L(t?.msg||l("categories.medicalRent.request.success")),B.push(y({path:"/profile/orders/rental",query:{tab:"sent"}}));else throw new Error(t?.msg||l("categories.medicalRent.request.error"))}catch(t){console.error(t),E(t.error||t.message||l("categories.medicalRent.request.error"))}});return se({title:l("categories.medicalRent.request.title")}),(o,t)=>{const J=Z,Y=K;return d(),i("div",fe,[s("div",ve,[p(J,{items:e(V),direction:"ltr"},null,8,["items"])]),s("div",_e,[s("div",ye,[s("form",{onSubmit:t[7]||(t[7]=oe((...r)=>e(C)&&e(C)(...r),["prevent"])),class:"space-y-6"},[s("div",xe,[s("label",qe,n(o.$t("categories.medicalRent.request.rentPeriod")),1),m(s("input",g({"onUpdate:modelValue":t[0]||(t[0]=r=>h(f)?f.value=r:null)},e(z),{onInput:t[1]||(t[1]=r=>{f.value=r.target.value.replace(/\D/g,"")}),type:"text",placeholder:o.$t("categories.medicalRent.request.rentPeriod"),class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none",{"ring-2 ring-red-500/50":e(a).rentPeriod}]}),null,16,ke),[[v,e(f)]]),e(a).rentPeriod?(d(),i("span",we,n(e(a).rentPeriod),1)):b("",!0)]),s("div",Re,[s("label",$e,n(o.$t("categories.medicalRent.request.quantity")),1),s("div",Pe,[m(s("select",g({"onUpdate:modelValue":t[2]||(t[2]=r=>h(x)?x.value=r:null)},e(I),{class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none appearance-none text-[#5d4037]",{"ring-2 ring-red-500/50":e(a).quantity}]}),[s("option",Ee,n(o.$t("categories.medicalRent.request.selectQuantity")),1),(d(),i(ae,null,ne(10,r=>s("option",{key:r,value:r},n(r),9,De)),64))],16),[[re,e(x)]]),s("div",Ae,[p(e(ge),{size:"20"})])]),e(a).quantity?(d(),i("span",Ce,n(e(a).quantity),1)):b("",!0)]),s("div",Fe,[s("label",Be,n(o.$t("categories.medicalRent.request.startDate")),1),m(s("input",g({"onUpdate:modelValue":t[3]||(t[3]=r=>h(q)?q.value=r:null)},e(T),{type:"date",placeholder:o.$t("categories.medicalRent.request.startDate"),class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none block",{"ring-2 ring-red-500/50":e(a).startDate}]}),null,16,Le),[[v,e(q)]]),e(a).startDate?(d(),i("span",Se,n(e(a).startDate),1)):b("",!0)]),s("div",Ve,[s("label",Me,n(o.$t("categories.medicalRent.request.deviceLocation")),1),s("div",{class:"relative cursor-pointer",onClick:t[5]||(t[5]=r=>u.value=!0)},[m(s("input",g({"onUpdate:modelValue":t[4]||(t[4]=r=>h(k)?k.value=r:null)},e(j),{type:"text",readonly:"",placeholder:o.$t("categories.medicalRent.request.deviceLocation"),class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 pl-12 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none cursor-pointer",{"ring-2 ring-red-500/50":e(a).location}]}),null,16,Ne),[[v,e(k)]]),s("div",Ue,[s("div",ze,[p(e(he),{size:"14"})])])]),e(a).location?(d(),i("span",Ie,n(e(a).location),1)):b("",!0)]),s("div",Te,[s("label",je,n(o.$t("categories.medicalRent.request.notes")),1),m(s("textarea",g({"onUpdate:modelValue":t[6]||(t[6]=r=>h(w)?w.value=r:null)},e(H),{rows:"4",placeholder:o.$t("categories.medicalRent.request.notes"),class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none resize-none",{"ring-2 ring-red-500/50":e(a).notes}]}),null,16,He),[[v,e(w)]]),e(a).notes?(d(),i("span",Qe,n(e(a).notes),1)):b("",!0)]),s("div",Ge,[s("button",{type:"submit",disabled:e(A),class:"w-full bg-gradient-to-r from-[#A63C12] to-[#8F300E] text-white font-bold py-4 rounded-xl shadow-lg hover:shadow-xl transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed"},[e(A)?(d(),i("span",Ze,[le(n(o.$t("categories.medicalRent.request.sending"))+" ",1),p(e(be),{class:"animate-spin",size:"20"})])):(d(),i("span",Ye,n(o.$t("categories.medicalRent.request.send")),1))],8,Je)])],32)])]),p(Y,{"is-open":e(u),onClose:t[8]||(t[8]=r=>u.value=!1),onLocationSelected:Q},null,8,["is-open"])])}}};export{ut as default};
