import{ak as g,K as l,G as R,a1 as i,R as c}from"./B0kbPVzu.js";import{u as k}from"./D1kvvfSo.js";const S=async({url:u,method:h="get",query:s,data:r,options:f})=>{const{baseURL:n}=g(),e=l(),o=R();return e.isAuthenticated||e.initAuth(),k(u,{method:h,query:s,baseURL:n,key:u,body:r,onRequest({options:t}){t.headers=t.headers||{};const a=e.getToken;a&&(t.headers.authorization=`Token ${a}`)},onResponse({response:t,options:a}){const d=[400,422,500,401,"CORS error"];(t==null?void 0:t.status)===401&&(e.clearAuth(),i(()=>{c(o("/auth/login"))})),!d.includes(t.status)&&a.method!=="GET"&&t._data&&t._data.message},onResponseError({response:t}){var a;(t==null?void 0:t.status)===401&&(e.clearAuth(),i(()=>{c(o("/auth/login"))})),(a=t._data)!=null&&a.errors},...f},"$18Vz6g5l--")};export{S as u};
