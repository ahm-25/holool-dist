import{_ as K}from"./BlwJ1uXT.js";import{E as Q,r as E,a0 as X,g as Y,G as Z,R as ee,c as u,o as p,a as s,b as r,C as t,M as y,t as n,w as v,T as g,F as B,B as S,S as te}from"./BYEf0NBg.js";import{c as se,f as le,b as w,g as k,u as ie,F as d,E as c}from"./CbWQZxt2.js";import{_ as ae}from"./JxVkkAUH.js";import{u as oe}from"./Csww0FSG.js";import{u as re}from"./SR-Rvwwp.js";import{M as ne}from"./C9Mv1BY4.js";import{C as de}from"./Co_PEXwa.js";import"./BIzi2wWj.js";import"./D2tlbMjF.js";import"./cSiaAbyi.js";import"./WbP1RNmY.js";const ce={class:"min-h-screen w-full relative overflow-hidden p-6 sm:p-10"},ue={class:"w-full max-w-2xl mx-auto mb-6"},pe={class:"w-full max-w-2xl bg-white/40 backdrop-blur-md rounded-[2.5rem] p-6 md:p-10 border border-white/60 mx-auto z-10 shadow-xl"},ve={class:"flex justify-start mb-8"},me={class:"bg-white/50 p-1.5 rounded-2xl flex items-center relative w-48 shadow-sm border border-white/60"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},he={class:"flex flex-col gap-2"},fe={class:"text-xs font-bold opacity-70"},ge=["placeholder"],be={class:"flex flex-col gap-2"},_e={class:"text-xs font-bold opacity-70"},ye=["placeholder","dir"],we={class:"flex flex-col gap-2"},ke={class:"text-xs font-bold opacity-70"},qe={disabled:"",value:""},Ee=["value"],Ce={class:"flex flex-col gap-2"},Ae={class:"text-xs font-bold opacity-70"},Le={disabled:"",value:""},De={value:1},Fe={value:0},Ie={class:"flex flex-col gap-2"},Ne={class:"text-xs font-bold opacity-70"},$e=["placeholder"],Me={class:"flex flex-col gap-2"},Be={class:"text-xs font-bold opacity-70"},Se=["placeholder"],je={class:"flex flex-col gap-2"},ze={class:"text-xs font-bold opacity-70"},Pe=["onChange"],Ue={key:0,class:"grid grid-cols-3 gap-2 w-full"},Re=["src"],Oe=["onClick"],Te={key:1,class:"text-gray-500 group-hover:text-brand-primary flex flex-col items-center"},Ve={class:"text-xs"},We={class:"flex flex-col gap-2"},Ge={class:"text-xs font-bold opacity-70"},He=["placeholder"],Je={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ke={class:"flex flex-col gap-2"},Qe={class:"text-xs font-bold opacity-70"},Xe=["value","onInput","onBlur","placeholder"],Ye={class:"flex flex-col gap-2"},Ze={class:"text-xs font-bold opacity-70"},et=["value","onInput","onBlur","placeholder","dir"],tt={class:"pt-4 border-t border-gray-200/20"},st={class:"flex flex-col gap-2"},lt={class:"text-xs font-bold opacity-70"},it={class:"flex items-center gap-2 overflow-hidden"},at={key:0,class:"text-gray-700 truncate"},ot={key:1,class:"text-gray-400"},rt={class:"flex flex-col gap-2 mt-4"},nt={class:"text-xs font-bold opacity-70"},dt=["placeholder"],ct={class:"pt-4"},ut=["disabled"],pt={key:0},vt={key:1},q="w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-1 focus:ring-brand-primary/50 focus:bg-white/60 transition-all placeholder:text-gray-400",j="w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-1 focus:ring-brand-primary/50 focus:bg-white/60 transition-all text-gray-700",z="w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-1 focus:ring-brand-primary/50 focus:bg-white/60 transition-all placeholder:text-gray-400 resize-none",x="border-red-500/50 focus:ring-red-500/20 bg-red-50/50",Lt={__name:"add-device",setup(mt){const{t:e}=Q(),P=se({titleAr:w().trim().required(e("validation.required")).min(3,e("validation.min",{min:3})).max(100,e("validation.max",{max:100})).label(e("devices.nameAr")),titleEn:w().trim().required(e("validation.required")).min(3,e("validation.min",{min:3})).max(100,e("validation.max",{max:100})).label(e("devices.nameEn")),supplierName:w().trim().required(e("validation.required")).max(100,e("validation.max",{max:100})).label(e("devices.supplier")),deviceClassId:k().transform((i,l)=>l===""?void 0:i).required(e("validation.required")).label(e("devices.class")),isNew:k().required(e("validation.required")).oneOf([0,1],e("validation.invalid_value")).label(e("devices.condition")),quantity:k().transform((i,l)=>l===""?void 0:i).typeError(e("validation.number")).required(e("validation.required")).min(1,e("validation.minNumber",{min:1})).label(e("devices.quantityLabel")),lat:k().transform((i,l)=>l===""?void 0:i).typeError(e("validation.number")).required(e("validation.required")).label(e("devices.lat")),lng:k().transform((i,l)=>l===""?void 0:i).typeError(e("validation.number")).required(e("validation.required")).label(e("devices.lng")),mapDesc:w().required(e("validation.required")).label(e("devices.locationDesc")),price:k().transform((i,l)=>l===""?void 0:i).typeError(e("validation.number")).required(e("validation.required")).positive(e("validation.positive")).min(.01,e("validation.minNumber",{min:.01})).label(e("devices.priceLabel")),descriptionAr:w().trim().required(e("validation.required")).max(1e3,e("validation.max",{max:1e3})).label(e("devices.descAr")),descriptionEn:w().trim().required(e("validation.required")).max(1e3,e("validation.max",{max:1e3})).label(e("devices.descEn")),images:le().min(1,e("validation.at_least_one_image")).required(e("validation.required")).test("fileType",e("validation.image_files_only"),i=>!i||i.length===0?!0:i.every(l=>l instanceof File&&l.type.startsWith("image/"))).test("fileSize",e("validation.file_size_limit"),i=>!i||i.length===0?!0:i.every(l=>l.size<=5*1024*1024)).label(e("devices.images"))}),{handleSubmit:U,setFieldValue:A,resetForm:R,values:h,errors:D}=ie({validationSchema:P,initialValues:{titleAr:"",titleEn:"",supplierName:"",deviceClassId:"",isNew:1,quantity:"",lat:"",lng:"",mapDesc:"",price:"",descriptionAr:"",descriptionEn:"",images:[]}}),_=E("sale"),L=E(!1),O=i=>{A("lat",i.lat),A("lng",i.lng),A("mapDesc",i.address)};X(()=>{R(),_.value="sale",m.value.forEach(i=>URL.revokeObjectURL(i)),m.value=new Map});const T=Y(()=>[{value:1,label:e("devices.type_heavy")},{value:2,label:e("devices.type_medical")},{value:3,label:e("devices.type_electronic")},{value:4,label:e("devices.type_agri")}]),F=E(null),m=E(new Map);function V(){F.value.click()}function W(i,l){const f=Array.from(i.target.files||[]);f.length&&(f.forEach(a=>{if(!m.value.has(a)){const o=URL.createObjectURL(a);m.value.set(a,o)}}),l(Array.from(m.value.keys())))}function G(i,l){const f=m.value.get(i);f&&URL.revokeObjectURL(f),m.value.delete(i),l(Array.from(m.value.keys()))}function I(i){return _.value==="sale"&&i==="sale"||_.value==="rent"&&i==="rent"?"flex-1 py-1.5 text-sm font-bold rounded-xl bg-[#8F300E] text-white shadow-md transition-all":"flex-1 py-1.5 text-sm font-bold rounded-xl text-gray-500 hover:bg-white/40 transition-all"}const{upload:H}=oe(),C=E(!1),N=re(),J=Z(),$=U(async i=>{C.value=!0;try{const l=new FormData;l.append("title[ar]",i.titleAr),l.append("title[en]",i.titleEn),l.append("supplier_name",i.supplierName),l.append("price",i.price),l.append("device_class_id",i.deviceClassId),l.append("is_new",i.isNew),l.append("quantity",i.quantity),l.append("type",_.value),l.append("description[ar]",i.descriptionAr),l.append("description[en]",i.descriptionEn),l.append("lat",i.lat),l.append("lng",i.lng),l.append("map_desc",i.mapDesc),i.images&&i.images.length&&i.images.forEach(a=>{l.append("images[]",a)}),console.log("Submitting FormData...");const f=await H("/store-machine",l);N.success(e("messages.success")),ee(J("/profile/more/devices"))}catch(l){console.error("Error adding device:",l),N.error(l.error||e("error.somethingWentWrong"))}finally{C.value=!1}});return(i,l)=>{const f=K;return p(),u("div",ce,[s("div",ue,[r(f,{items:[{label:t(e)("profile.more.menuItems.market"),to:"/profile/more",active:!1},{label:t(e)("devices.breadcrumb.devices"),to:"/profile/more/devices",active:!1},{label:t(e)("devices.addDevice"),to:"/profile/more/devices/add-device",active:!0}],direction:i.$i18n.locale==="ar"?"rtl":"ltr"},null,8,["items","direction"])]),s("div",pe,[s("div",ve,[s("div",me,[s("button",{type:"button",onClick:l[0]||(l[0]=a=>_.value="sale"),class:y(I("sale"))},n(t(e)("devices.sale")),3),s("button",{type:"button",onClick:l[1]||(l[1]=a=>_.value="rent"),class:y(I("rent"))},n(t(e)("devices.rent")),3)])]),s("form",{onSubmit:l[4]||(l[4]=(...a)=>t($)&&t($)(...a)),class:"space-y-4"},[s("div",xe,[s("div",he,[s("label",fe,n(t(e)("devices.nameAr")),1),r(t(d),{name:"titleAr"},{default:v(({field:a,meta:o})=>[s("input",g(a,{placeholder:t(e)("devices.nameArPlaceholder"),class:[q,o.touched&&o.invalid&&x]}),null,16,ge)]),_:1}),r(t(c),{name:"titleAr",class:"text-red-500 text-xs pr-1"})]),s("div",be,[s("label",_e,n(t(e)("devices.nameEn")),1),r(t(d),{name:"titleEn"},{default:v(({field:a,meta:o})=>[s("input",g(a,{placeholder:t(e)("devices.nameEn"),dir:a.value?"ltr":i.$i18n.locale==="ar"?"rtl":"ltr",class:[q,o.touched&&o.invalid&&x]}),null,16,ye)]),_:1}),r(t(c),{name:"titleEn",class:"text-red-500 text-xs pr-1 block text-right"})])]),s("div",we,[s("label",ke,n(t(e)("devices.class")),1),r(t(d),{name:"deviceClassId"},{default:v(({field:a,meta:o})=>[s("select",g(a,{class:[j,o.touched&&o.invalid&&x]}),[s("option",qe,n(t(e)("devices.selectClass")),1),(p(!0),u(B,null,S(T.value,b=>(p(),u("option",{key:b.value,value:b.value},n(b.label),9,Ee))),128))],16)]),_:1}),r(t(c),{name:"deviceClassId",class:"text-red-500 text-xs pr-1"})]),s("div",Ce,[s("label",Ae,n(t(e)("devices.condition")),1),r(t(d),{name:"isNew"},{default:v(({field:a,meta:o})=>[s("select",g(a,{class:[j,o.touched&&o.invalid&&x]}),[s("option",Le,n(t(e)("devices.selectCondition")),1),s("option",De,n(t(e)("devices.new")),1),s("option",Fe,n(t(e)("devices.used")),1)],16)]),_:1}),r(t(c),{name:"isNew",class:"text-red-500 text-xs pr-1"})]),s("div",Ie,[s("label",Ne,n(t(e)("devices.quantityLabel")),1),r(t(d),{name:"quantity"},{default:v(({field:a,meta:o})=>[s("input",g(a,{type:"number",placeholder:t(e)("devices.quantityLabel"),class:[q,o.touched&&o.invalid&&x]}),null,16,$e)]),_:1}),r(t(c),{name:"quantity",class:"text-red-500 text-xs pr-1"})]),s("div",Me,[s("label",Be,n(t(e)("devices.supplier")),1),r(t(d),{name:"supplierName"},{default:v(({field:a,meta:o})=>[s("input",g(a,{placeholder:t(e)("devices.supplierPlaceholder"),class:[q,o.touched&&o.invalid&&x]}),null,16,Se)]),_:1}),r(t(c),{name:"supplierName",class:"text-red-500 text-xs pr-1"})]),s("div",je,[s("label",ze,n(t(e)("devices.images")),1),r(t(d),{name:"images"},{default:v(({field:a,meta:o})=>[s("div",{onClick:V,class:y(["w-full bg-white/40 min-h-[6rem] rounded-xl border-2 border-dashed border-gray-400/30 flex flex-col items-center justify-center cursor-pointer hover:bg-white/60 transition overflow-hidden relative group p-4",[o.touched&&o.invalid&&"border-red-500/50"]])},[s("input",{type:"file",ref_key:"fileInput",ref:F,class:"hidden",accept:"image/*",multiple:"",onChange:b=>W(b,a.onChange)},null,40,Pe),m.value.size>0?(p(),u("div",Ue,[(p(!0),u(B,null,S(m.value,([b,M])=>(p(),u("div",{key:M,class:"relative aspect-square rounded-lg overflow-hidden border border-black/10 group/img"},[s("img",{src:M,class:"w-full h-full object-cover"},null,8,Re),s("button",{type:"button",onClick:te(xt=>G(b,a.onChange),["stop"]),class:"absolute top-1 right-1 bg-red-500/80 hover:bg-red-600 text-white p-1 rounded-full opacity-0 group-hover/img:opacity-100 transition-all transform hover:scale-110 shadow-lg z-20"},l[5]||(l[5]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Oe)]))),128)),l[6]||(l[6]=s("div",{class:"flex items-center justify-center text-xs text-brand-primary font-bold bg-white/50 rounded-lg"}," + ",-1))])):(p(),u("div",Te,[l[7]||(l[7]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-2 opacity-60",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),s("span",Ve,n(t(e)("devices.uploadImages")),1)]))],2)]),_:1}),r(t(c),{name:"images",class:"text-red-500 text-xs pr-1"})]),s("div",We,[s("label",Ge,n(t(e)("devices.priceLabel")),1),r(t(d),{name:"price"},{default:v(({field:a,meta:o})=>[s("input",g(a,{type:"number",placeholder:t(e)("devices.priceLabel"),class:[q,o.touched&&o.invalid&&x]}),null,16,He)]),_:1}),r(t(c),{name:"price",class:"text-red-500 text-xs pr-1"})]),s("div",Je,[s("div",Ke,[s("label",Qe,n(t(e)("devices.descAr")),1),r(t(d),{name:"descriptionAr"},{default:v(({field:a,meta:o})=>[s("textarea",{value:a.value,onInput:a.onChange,onBlur:a.onBlur,placeholder:t(e)("devices.descArPlaceholder"),rows:"4",class:y([z,o.touched&&o.invalid&&x])},null,42,Xe)]),_:1}),r(t(c),{name:"descriptionAr",class:"text-red-500 text-xs pr-1"})]),s("div",Ye,[s("label",Ze,n(t(e)("devices.descEn")),1),r(t(d),{name:"descriptionEn"},{default:v(({field:a,meta:o})=>[s("textarea",{value:a.value,onInput:a.onChange,onBlur:a.onBlur,placeholder:t(e)("devices.descEn"),dir:a.value?"ltr":i.$i18n.locale==="ar"?"rtl":"ltr",rows:"4",class:y([z,o.touched&&o.invalid&&x])},null,42,et)]),_:1}),r(t(c),{name:"descriptionEn",class:"text-red-500 text-xs pr-1 block text-right"})])]),s("div",tt,[s("div",st,[s("label",lt,n(t(e)("devices.location")),1),s("div",{onClick:l[2]||(l[2]=a=>L.value=!0),class:y(["w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm cursor-pointer hover:bg-white/60 transition-all flex items-center justify-between group",[t(D).lat||t(D).lng?"border-red-500/50 bg-red-50/50":""]])},[s("div",it,[r(t(ne),{class:"w-4 h-4 text-[#8F300E] shrink-0"}),t(h).lat&&t(h).lng?(p(),u("span",at,n(t(h).mapDesc||`${t(h).lat}, ${t(h).lng}`),1)):(p(),u("span",ot,n(t(e)("devices.selectLocationOnMap")),1))]),r(t(de),{class:"w-4 h-4 text-gray-400 group-hover:text-[#8F300E] transition-colors"})],2),r(t(d),{name:"lat",type:"hidden"}),r(t(d),{name:"lng",type:"hidden"}),r(t(c),{name:"lat",class:"text-red-500 text-xs pr-1"})]),s("div",rt,[s("label",nt,n(t(e)("devices.locationDesc")),1),r(t(d),{name:"mapDesc"},{default:v(({field:a,meta:o})=>[s("input",g(a,{placeholder:t(e)("devices.locationPlaceholder"),class:[q,o.touched&&o.invalid&&x]}),null,16,dt)]),_:1}),r(t(c),{name:"mapDesc",class:"text-red-500 text-xs pr-1"})])]),r(ae,{"is-open":L.value,"initial-lat":t(h).lat?Number(t(h).lat):24.7136,"initial-lng":t(h).lng?Number(t(h).lng):46.6753,onClose:l[3]||(l[3]=a=>L.value=!1),onLocationSelected:O},null,8,["is-open","initial-lat","initial-lng"]),s("div",ct,[s("button",{type:"submit",class:"w-full py-4 text-white font-bold text-lg rounded-xl shadow-lg bg-gradient-to-r from-[#8F300E] to-[#D2592D] hover:shadow-xl hover:scale-[1.01] transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:C.value},[C.value?(p(),u("span",pt,n(t(e)("devices.adding")),1)):(p(),u("span",vt,n(t(e)("devices.addDevice")),1))],8,ut)])],32)]),l[8]||(l[8]=s("div",{class:"fixed inset-0 pointer-events-none -z-10 bg-[#E8E0DA]/30"},[s("div",{class:"absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-[#D2592D]/5 rounded-full blur-[120px]"}),s("div",{class:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-[#8F300E]/10 rounded-full blur-[100px]"})],-1))])}}};export{Lt as default};
