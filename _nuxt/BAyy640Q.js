import{_ as le}from"./B3_awDU6.js";import{_ as ie,a4 as ae,E as oe,g as M,r as E,G as re,W as de,n as ne,R as ce,c as n,o as c,a as s,J as T,b as r,C as a,M as D,t as d,w as p,T as m,F as N,B as F,S as pe}from"./OI3PzNV2.js";import{c as ue,f as ve,b as _,g as $,u as me,F as u,E as v}from"./B-tkdhUT.js";import{a as he,u as fe,b as be}from"./F73BFBEp.js";import{u as ge}from"./CYfhutIQ.js";import{T as _e}from"./D8tzh7tL.js";import{X as xe}from"./CON-E_BH.js";import{P as ye}from"./CGGGxzb9.js";import{c as we}from"./CpGMb49Z.js";import"./XDG_G50n.js";import"./DwuVNmEu.js";import"./C37uFHYe.js";/**
 * @license lucide-vue-next v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=we("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),$e={class:"min-h-screen w-full relative overflow-hidden p-6 sm:p-10"},Ae={class:"w-full max-w-2xl mx-auto mb-6"},Ce={key:0,class:"w-full max-w-2xl bg-white/40 backdrop-blur-md rounded-[2.5rem] p-6 md:p-10 border border-white/60 mx-auto z-10 shadow-xl"},ke={class:"flex justify-start mb-8"},qe={class:"bg-white/50 p-1.5 rounded-2xl flex items-center relative w-48 shadow-sm border border-white/60"},De={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ne={class:"flex flex-col gap-2"},Fe={class:"text-xs font-bold opacity-70"},Ie=["placeholder"],Se={class:"flex flex-col gap-2"},Le={class:"text-xs font-bold opacity-70"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ze={class:"flex flex-col gap-2"},je={class:"text-xs font-bold opacity-70"},Re=["placeholder"],Me={class:"flex flex-col gap-2"},Te={class:"text-xs font-bold opacity-70"},Be={class:"flex flex-col gap-2"},Ue={class:"text-xs font-bold opacity-70"},Ge={disabled:"",value:""},Je=["value"],Oe={class:"flex flex-col gap-2"},We={class:"text-xs font-bold opacity-70"},Xe={disabled:"",value:""},He={value:1},Ke={value:0},Qe={class:"flex flex-col gap-2"},Ye={class:"text-xs font-bold opacity-70"},Ze={key:0,class:"grid grid-cols-3 gap-3 mb-3"},Ve=["src"],es=["onClick"],ss=["onChange"],ts={key:0,class:"grid grid-cols-3 gap-2 w-full"},ls=["src"],is=["onClick"],as={class:"flex items-center justify-center text-xs text-[#8F300E] font-bold bg-white/50 rounded-lg aspect-square border border-dashed border-[#8F300E]/30"},os={key:1,class:"text-gray-500 group-hover:text-[#8F300E] flex flex-col items-center"},rs={class:"text-xs"},ds={class:"flex flex-col gap-2"},ns={class:"text-xs font-bold opacity-70"},cs=["placeholder"],ps={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},us={class:"flex flex-col gap-2"},vs={class:"text-xs font-bold opacity-70"},ms=["placeholder"],hs={class:"flex flex-col gap-2"},fs={class:"text-xs font-bold opacity-70"},bs={class:"pt-4 border-t border-gray-200/20"},gs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},_s={class:"flex flex-col gap-2"},xs={class:"text-xs font-bold opacity-70"},ys={class:"flex flex-col gap-2"},ws={class:"text-xs font-bold opacity-70"},Es={class:"flex flex-col gap-2 mt-4"},$s={class:"text-xs font-bold opacity-70"},As=["placeholder"],Cs={class:"pt-4"},ks=["disabled"],qs={key:0},Ds={key:1},Ns={key:1,class:"flex items-center justify-center min-h-[400px]"},f="w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-1 focus:ring-[#8F300E]/50 focus:bg-white/60 transition-all placeholder:text-gray-400",B="w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-1 focus:ring-[#8F300E]/50 focus:bg-white/60 transition-all text-gray-700",U="w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-1 focus:ring-[#8F300E]/50 focus:bg-white/60 transition-all placeholder:text-gray-400 resize-none",h="border-red-500/50 focus:ring-red-500/20 bg-red-50/50",Fs={__name:"[id]",async setup(Is){let A,I;const q=ae().params.id,{t:o,locale:G}=oe(),J=M(()=>G.value==="ar"),O=ue({titleAr:_().required(o("validation.required","مطلوب")).label(o("devices.nameAr","اسم الجهاز (عربي)")),titleEn:_().required("Required").label(o("devices.nameEn","اسم الجهاز (إنجليزي)")),supplierNameAr:_().required(o("validation.required","مطلوب")).label(o("devices.supplierAr","اسم المورد (عربي)")),supplierNameEn:_().required("Required").label(o("devices.supplierEn","اسم المورد (إنجليزي)")),deviceClassId:$().required(o("validation.required","مطلوب")).label(o("devices.class","الفئة")),isNew:$().required(o("validation.required","مطلوب")).label(o("devices.condition","حالة الجهاز")),lat:$().required(o("validation.required","مطلوب")).label(o("devices.lat","خط العرض")),lng:$().required(o("validation.required","مطلوب")).label(o("devices.lng","خط الطول")),mapDesc:_().required(o("validation.required","مطلوب")).label(o("devices.locationDesc","وصف الموقع")),price:$().required(o("validation.required","مطلوب")).label(o("devices.priceLabel","السعر")),descriptionAr:_().required(o("validation.required","مطلوب")).label(o("devices.descAr","وصف الجهاز (عربي)")),descriptionEn:_().required("Required").label(o("devices.descEn","وصف الجهاز (إنجليزي)")),images:ve().nullable().label(o("devices.images","صور الجهاز"))}),{handleSubmit:W,setValues:X}=me({validationSchema:O}),y=E("sale"),w=E([]),H=[{value:1,label:o("devices.type_heavy","آلات ثقيلة")},{value:2,label:o("devices.type_medical","معدات طبية")},{value:3,label:o("devices.type_electronic","أجهزة إلكترونية")},{value:4,label:o("devices.type_agri","معدات زراعية")}],{delete:K}=he(),{upload:Q}=fe(),C=ge(),Y=re(),k=E(!1),{data:Z,pending:S,error:Ls}=([A,I]=de(()=>be(`/machine-details/${q}`)),A=await A,I(),A),L=M(()=>{var e;return(e=Z.value)==null?void 0:e.data});ne(L,e=>{e&&(X({titleAr:e.title_ar,titleEn:e.title_en,supplierNameAr:e.supplier_name_ar,supplierNameEn:e.supplier_name_en,deviceClassId:e.device_class_id,isNew:e.is_new?1:0,price:e.price,descriptionAr:e.description_ar,descriptionEn:e.description_en,lat:e.lat,lng:e.lng,mapDesc:e.map_desc,images:[]}),y.value=e.type,w.value=e.images||[])},{immediate:!0});const P=E(null),b=E(new Map);function V(){P.value.click()}function ee(e,i){const x=Array.from(e.target.files||[]);x.length&&(x.forEach(l=>{if(!b.value.has(l)){const t=URL.createObjectURL(l);b.value.set(l,t)}}),i(Array.from(b.value.keys())))}function se(e,i){b.value.delete(e),i(Array.from(b.value.keys()))}const te=async e=>{if(confirm(o("devices.confirmDeleteImg","هل أنت متأكد من حذف هذه الصورة؟")))try{await K(`/delete-machine-img/${e}`),C.success(o("devices.deleteImgSuccess","تم حذف الصورة بنجاح")),w.value=w.value.filter(i=>i.id!==e)}catch{C.error(o("devices.deleteImgError","فشل حذف الصورة"))}};function z(e){return y.value===e?"flex-1 py-1.5 text-sm font-bold rounded-xl bg-[#8F300E] text-white shadow-md transition-all":"flex-1 py-1.5 text-sm font-bold rounded-xl text-gray-500 hover:bg-white/40 transition-all"}const j=W(async e=>{k.value=!0;try{const i=new FormData;i.append("title[ar]",e.titleAr),i.append("title[en]",e.titleEn),i.append("supplier_name[ar]",e.supplierNameAr),i.append("supplier_name[en]",e.supplierNameEn),i.append("price",e.price),i.append("device_class_id",e.deviceClassId),i.append("is_new",e.isNew),i.append("type",y.value),i.append("description[ar]",e.descriptionAr),i.append("description[en]",e.descriptionEn),i.append("lat",e.lat),i.append("lng",e.lng),i.append("map_desc",e.mapDesc),e.images&&e.images.length&&e.images.forEach(x=>{i.append("images[]",x)}),await Q(`/edit-machine/${q}?_method=put`,i),C.success(o("devices.editSuccess","تم تعديل الجهاز بنجاح!")),ce(Y("/profile/more/devices"))}catch(i){C.error(i.error||o("devices.editError","حدث خطأ أثناء تعديل الجهاز"))}finally{k.value=!1}});return(e,i)=>{const x=le;return c(),n("div",$e,[s("div",Ae,[r(x,{items:[{label:e.$t("devices.breadcrumb.more","المزيد"),to:"/profile/more",active:!1},{label:e.$t("devices.breadcrumb.devices","الأجهزة"),to:"/profile/more/devices",active:!1},{label:e.$t("devices.edit","تعديل جهاز"),to:`/profile/more/devices/edit/${a(q)}`,active:!0}],direction:J.value?"rtl":"ltr"},null,8,["items","direction"])]),!a(S)&&L.value?(c(),n("div",Ce,[s("div",ke,[s("div",qe,[s("button",{type:"button",onClick:i[0]||(i[0]=l=>y.value="sale"),class:D(z("sale"))},d(e.$t("devices.sale","بيع")),3),s("button",{type:"button",onClick:i[1]||(i[1]=l=>y.value="rent"),class:D(z("rent"))},d(e.$t("devices.rent","إيجار")),3)])]),s("form",{onSubmit:i[2]||(i[2]=(...l)=>a(j)&&a(j)(...l)),class:"space-y-4"},[s("div",De,[s("div",Ne,[s("label",Fe,d(e.$t("devices.nameAr","اسم الجهاز (عربي)")),1),r(a(u),{name:"titleAr"},{default:p(({field:l,meta:t})=>[s("input",m(l,{placeholder:e.$t("devices.nameArPlaceholder","اسم الجهاز"),class:[f,t.touched&&t.invalid&&h]}),null,16,Ie)]),_:1}),r(a(v),{name:"titleAr",class:"text-red-500 text-xs pr-1"})]),s("div",Se,[s("label",Le,d(e.$t("devices.nameEn","اسم الجهاز (إنجليزي)")),1),r(a(u),{name:"titleEn"},{default:p(({field:l,meta:t})=>[s("input",m(l,{placeholder:"Device Name",dir:"ltr",class:[f,t.touched&&t.invalid&&h]}),null,16)]),_:1}),r(a(v),{name:"titleEn",class:"text-red-500 text-xs pr-1"})])]),s("div",Pe,[s("div",ze,[s("label",je,d(e.$t("devices.supplierAr","اسم المورد (عربي)")),1),r(a(u),{name:"supplierNameAr"},{default:p(({field:l,meta:t})=>[s("input",m(l,{placeholder:e.$t("devices.supplierPlaceholder","اسم المورد"),class:[f,t.touched&&t.invalid&&h]}),null,16,Re)]),_:1}),r(a(v),{name:"supplierNameAr",class:"text-red-500 text-xs pr-1"})]),s("div",Me,[s("label",Te,d(e.$t("devices.supplierEn","اسم المورد (إنجليزي)")),1),r(a(u),{name:"supplierNameEn"},{default:p(({field:l,meta:t})=>[s("input",m(l,{placeholder:"Supplier Name",dir:"ltr",class:[f,t.touched&&t.invalid&&h]}),null,16)]),_:1}),r(a(v),{name:"supplierNameEn",class:"text-red-500 text-xs pr-1"})])]),s("div",Be,[s("label",Ue,d(e.$t("devices.class","الفئة")),1),r(a(u),{name:"deviceClassId"},{default:p(({field:l,meta:t})=>[s("select",m(l,{class:[B,t.touched&&t.invalid&&h]}),[s("option",Ge,d(e.$t("devices.selectClass","اختر الفئة")),1),(c(),n(N,null,F(H,g=>s("option",{key:g.value,value:g.value},d(g.label),9,Je)),64))],16)]),_:1}),r(a(v),{name:"deviceClassId",class:"text-red-500 text-xs pr-1"})]),s("div",Oe,[s("label",We,d(e.$t("devices.condition","حالة الجهاز")),1),r(a(u),{name:"isNew"},{default:p(({field:l,meta:t})=>[s("select",m(l,{class:[B,t.touched&&t.invalid&&h]}),[s("option",Xe,d(e.$t("devices.selectCondition","اختر حالة الجهاز")),1),s("option",He,d(e.$t("devices.new","جديد")),1),s("option",Ke,d(e.$t("devices.used","مستعمل")),1)],16)]),_:1}),r(a(v),{name:"isNew",class:"text-red-500 text-xs pr-1"})]),s("div",Qe,[s("label",Ye,d(e.$t("devices.images","صور الجهاز")),1),w.value.length>0?(c(),n("div",Ze,[(c(!0),n(N,null,F(w.value,l=>(c(),n("div",{key:l.id,class:"relative aspect-square rounded-xl overflow-hidden border border-black/5 shadow-sm group"},[s("img",{src:l.image,class:"w-full h-full object-cover"},null,8,Ve),s("button",{type:"button",onClick:t=>te(l.id),class:"absolute top-1 right-1 bg-red-500/80 text-white p-1 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity"},[r(a(_e),{size:14})],8,es)]))),128))])):T("",!0),r(a(u),{name:"images"},{default:p(({field:l,meta:t})=>[s("div",{onClick:V,class:D(["w-full bg-white/40 min-h-[6rem] rounded-xl border-2 border-dashed border-gray-400/30 flex flex-col items-center justify-center cursor-pointer hover:bg-white/60 transition overflow-hidden relative group p-4",[t.touched&&t.invalid&&"border-red-500/50"]])},[s("input",{type:"file",ref_key:"fileInput",ref:P,class:"hidden",accept:"image/*",multiple:"",onChange:g=>ee(g,l.onChange)},null,40,ss),b.value.size>0?(c(),n("div",ts,[(c(!0),n(N,null,F(b.value,([g,R])=>(c(),n("div",{key:R,class:"relative aspect-square rounded-lg overflow-hidden border border-black/10 group"},[s("img",{src:R,class:"w-full h-full object-cover"},null,8,ls),s("button",{type:"button",onClick:pe(Ps=>se(g,l.onChange),["stop"]),class:"absolute top-1 right-1 bg-red-500/80 text-white p-1 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity"},[r(a(xe),{size:14})],8,is)]))),128)),s("div",as,[r(a(ye),{size:20})])])):(c(),n("div",os,[r(a(Ee),{size:24,class:"mb-2 opacity-60"}),s("span",rs,d(e.$t("devices.uploadImages","اضغط لرفع صور إضافية")),1)]))],2)]),_:1}),r(a(v),{name:"images",class:"text-red-500 text-xs pr-1"})]),s("div",ds,[s("label",ns,d(e.$t("devices.priceLabel","السعر")),1),r(a(u),{name:"price"},{default:p(({field:l,meta:t})=>[s("input",m(l,{type:"number",placeholder:e.$t("devices.priceLabel","السعر"),class:[f,t.touched&&t.invalid&&h]}),null,16,cs)]),_:1}),r(a(v),{name:"price",class:"text-red-500 text-xs pr-1"})]),s("div",ps,[s("div",us,[s("label",vs,d(e.$t("devices.descAr","وصف الجهاز (عربي)")),1),r(a(u),{name:"descriptionAr"},{default:p(({field:l,meta:t})=>[s("textarea",m(l,{placeholder:e.$t("devices.descArPlaceholder","وصف الجهاز"),rows:"4",class:[U,t.touched&&t.invalid&&h]}),null,16,ms)]),_:1}),r(a(v),{name:"descriptionAr",class:"text-red-500 text-xs pr-1"})]),s("div",hs,[s("label",fs,d(e.$t("devices.descEn","وصف الجهاز (إنجليزي)")),1),r(a(u),{name:"descriptionEn"},{default:p(({field:l,meta:t})=>[s("textarea",m(l,{placeholder:"Device Description",dir:"ltr",rows:"4",class:[U,t.touched&&t.invalid&&h]}),null,16)]),_:1}),r(a(v),{name:"descriptionEn",class:"text-red-500 text-xs pr-1"})])]),s("div",bs,[s("div",gs,[s("div",_s,[s("label",xs,d(e.$t("devices.lat","خط العرض (Latitude)")),1),r(a(u),{name:"lat"},{default:p(({field:l,meta:t})=>[s("input",m(l,{placeholder:"Example: 24.7136",type:"number",step:"any",class:[f,t.touched&&t.invalid&&h]}),null,16)]),_:1}),r(a(v),{name:"lat",class:"text-red-500 text-xs pr-1"})]),s("div",ys,[s("label",ws,d(e.$t("devices.lng","خط الطول (Longitude)")),1),r(a(u),{name:"lng"},{default:p(({field:l,meta:t})=>[s("input",m(l,{placeholder:"Example: 46.6753",type:"number",step:"any",class:[f,t.touched&&t.invalid&&h]}),null,16)]),_:1}),r(a(v),{name:"lng",class:"text-red-500 text-xs pr-1"})])]),s("div",Es,[s("label",$s,d(e.$t("devices.locationDesc","وصف الموقع")),1),r(a(u),{name:"mapDesc"},{default:p(({field:l,meta:t})=>[s("input",m(l,{placeholder:e.$t("devices.locationPlaceholder","وصف الموقع (مثال: الرياض، حي الملقا)"),class:[f,t.touched&&t.invalid&&h]}),null,16,As)]),_:1}),r(a(v),{name:"mapDesc",class:"text-red-500 text-xs pr-1"})])]),s("div",Cs,[s("button",{type:"submit",class:"w-full py-4 text-white font-bold text-lg rounded-xl shadow-lg bg-gradient-to-r from-[#8F300E] to-[#D2592D] hover:shadow-xl hover:scale-[1.01] transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:k.value},[k.value?(c(),n("span",qs,d(e.$t("devices.saving","جاري التعديل...")),1)):(c(),n("span",Ds,d(e.$t("devices.saveChanges","حفظ التعديلات")),1))],8,ks)])],32)])):a(S)?(c(),n("div",Ns,i[3]||(i[3]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-[#8F300E] border-t-transparent"},null,-1)]))):T("",!0),i[4]||(i[4]=s("div",{class:"fixed inset-0 pointer-events-none -z-10 bg-[#E8E0DA]/30"},[s("div",{class:"absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-[#D2592D]/5 rounded-full blur-[120px]"}),s("div",{class:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-[#8F300E]/10 rounded-full blur-[100px]"})],-1))])}}},Hs=ie(Fs,[["__scopeId","data-v-b09279c0"]]);export{Hs as default};
