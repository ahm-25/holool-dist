import{_ as L}from"./BFt8WF7K.js";import{b as c,c as j,u as D,F as b,E as p}from"./Bjx0cUm2.js";import{E as I,K as N,H as T,G as U,g as $,c as f,a as t,b as s,C as r,w as h,T as x,F as G,B as H,t as y,r as S,o as g}from"./lgLlP2OD.js";import{a as K}from"./BeeXXNaT.js";import{u as O}from"./C5wg_Vu0.js";import{U as R,M as J,B as Q}from"./DfgGNOmc.js";import{C as W}from"./CkxSdq50.js";import"./DnRb2zLH.js";import"./CGCT26qy.js";import"./D2f7vru_.js";import"./Ci3ZCnh3.js";const X={class:"min-h-screen w-full bg-gradient-to-br from-[#ede5e2] via-[#dcc3ba] to-[#c59a89] relative flex items-center justify-center p-4 overflow-hidden"},Y={class:"absolute top-4 right-4 md:top-8 md:right-8 z-10"},Z={class:"[&_nav]:!mb-0"},ee={class:"w-full max-w-2xl z-10"},te={class:"w-full backdrop-blur-xl bg-white/30 border border-white/40 rounded-[2rem] shadow-xl overflow-hidden p-6 md:p-10 lg:p-12 animate-fade-in-up"},ae={class:"relative group mt-2"},re={class:"relative group mt-2"},se={class:"relative group mt-2"},oe=["value"],ie={class:"pt-4 flex justify-center"},le=["disabled"],ye={__name:"change-profile",setup(ne){const k=[{label:"الإعدادات",to:"/profile/more/settings",active:!1},{label:"تعديل الملف الشخصي",to:"/profile/more/settings/change-profile",active:!0}],{t:n}=I(),o=N(),{get:B}=K(),u=O(),F=T(),z=U(),d=S(!1),E=c().trim().required(n("validation.required")).min(3,n("validation.min",{min:3})).max(50,n("validation.max",{max:50})).label("الاسم"),M=c().trim().nullable().transform(e=>e===""||!e?null:e).test("email-format",n("validation.email"),function(e){return!e||e.length===0?!0:c().email().isValidSync(e)}).label(n("auth.email")),P=c().required(n("validation.required")).label("المدينة"),V=j({name:E,email:M,city_id:P}),{handleSubmit:C,resetForm:v,setValues:de,values:ce}=D({validationSchema:V,initialValues:{name:"",email:"",city_id:""}}),_=S([]),q=async()=>{try{const e=await B("/cities");e?.data&&(_.value=e.data)}catch(e){console.error("Error fetching cities:",e)}};$(async()=>{o.initAuth(),await q(),d.value=!0;try{const e=await o.getProfile();e.success&&e.data?(console.log("Profile data loaded:",e.data),v({values:{name:e.data.name||"",email:e.data.email||"",city_id:e.data.city?.id||e.data.city_id||""}})):(console.error("Failed to load profile:",e.error),o.user&&v({values:{name:o.user.name||"",email:o.user.email||"",city_id:o.user.city?.id||o.user.city_id||""}}))}catch(e){console.error("Error in onMounted profile fetch:",e)}finally{d.value=!1}});const w=C(async e=>{d.value=!0;try{const a=await o.updateProfile({name:e.name,email:e.email,city_id:e.city_id});a.success?(u.success(a.message||"تم تحديث الملف الشخصي بنجاح"),F.push(z("/profile/more/settings"))):u.error(a.error||"فشل تحديث الملف الشخصي")}catch{u.error("حدث خطأ أثناء تحديث الملف الشخصي")}finally{d.value=!1}});return(e,a)=>{const A=L;return g(),f("div",X,[a[5]||(a[5]=t("div",{class:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-white/10 rounded-full blur-[100px]"},null,-1)),a[6]||(a[6]=t("div",{class:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-[#a04824]/20 rounded-full blur-[100px]"},null,-1)),t("div",Y,[t("div",Z,[s(A,{items:k,direction:"rtl"})])]),t("main",ee,[t("div",te,[t("form",{onSubmit:a[0]||(a[0]=(...l)=>r(w)&&r(w)(...l)),class:"flex flex-col gap-6 md:gap-8"},[t("div",null,[a[1]||(a[1]=t("label",{class:"text-[#5e4b44] font-bold text-sm md:text-base pr-1"},"اسم المستخدم",-1)),t("div",ae,[s(r(b),{name:"name"},{default:h(({field:l,meta:i})=>[t("input",x(l,{type:"text",placeholder:"اسم المستخدم",class:["w-full bg-white/40 border-2 rounded-xl py-3 pr-10 pl-4 text-right","text-[#5e4b44] placeholder-[#8c6b5d] outline-none transition-all",i.touched&&i.invalid?"border-red-500/50 focus:bg-white/60 focus:border-red-500/70":"border-transparent focus:bg-white/60 focus:border-[#a04824]/30 hover:bg-white/50"]}),null,16)]),_:1}),s(r(R),{size:"20",class:"absolute right-3 top-1/2 -translate-y-1/2 text-[#8c6b5d]"})]),s(r(p),{name:"name",class:"text-red-500 text-xs pr-1 mt-1 block text-right"})]),t("div",null,[a[2]||(a[2]=t("label",{class:"text-[#5e4b44] font-bold text-sm md:text-base pr-1"}," البريد الإلكتروني (اختياري) ",-1)),t("div",re,[s(r(b),{name:"email"},{default:h(({field:l,meta:i})=>[t("input",x(l,{type:"email",placeholder:"البريد الإلكتروني",class:["w-full bg-white/40 border-2 rounded-xl py-3 pr-10 pl-4 text-right","text-[#5e4b44] placeholder-[#8c6b5d] outline-none transition-all",i.touched&&i.invalid?"border-red-500/50 focus:bg-white/60 focus:border-red-500/70":"border-transparent focus:bg-white/60 focus:border-[#a04824]/30 hover:bg-white/50"]}),null,16)]),_:1}),s(r(J),{size:"20",class:"absolute right-3 top-1/2 -translate-y-1/2 text-[#8c6b5d]"})]),s(r(p),{name:"email",class:"text-red-500 text-xs pr-1 mt-1 block text-right"})]),t("div",null,[a[4]||(a[4]=t("label",{class:"text-[#5e4b44] font-bold text-sm md:text-base pr-1"},"المدينة",-1)),t("div",se,[s(r(b),{name:"city_id"},{default:h(({field:l,meta:i})=>[t("select",x(l,{class:["w-full bg-white/40 border-2 rounded-xl py-3 pr-10 pl-10 text-right appearance-none cursor-pointer outline-none transition-all","text-[#5e4b44]",i.touched&&i.invalid?"border-red-500/50 focus:bg-white/60 focus:border-red-500/70":"border-transparent focus:bg-white/60 focus:border-[#a04824]/30 hover:bg-white/50"],dir:"rtl"}),[a[3]||(a[3]=t("option",{disabled:"",value:""},"المدينة",-1)),(g(!0),f(G,null,H(_.value,m=>(g(),f("option",{class:"text-[#5e4b44] bg-[#f5f0ee]",key:m.id,value:m.id},y(m.name),9,oe))),128))],16)]),_:1}),s(r(Q),{size:"20",class:"absolute right-3 top-1/2 -translate-y-1/2 text-[#8c6b5d]"}),s(r(W),{size:"18",class:"absolute left-3 top-1/2 -translate-y-1/2 text-[#8c6b5d]"})]),s(r(p),{name:"city_id",class:"text-red-500 text-xs pr-1 mt-1 block text-right"})]),t("div",ie,[t("button",{type:"submit",disabled:d.value,class:"bg-gradient-to-l from-[#943d1b] to-[#c65d33] text-white font-bold text-lg py-3 px-12 rounded-xl shadow-[0_4px_14px_rgba(160,72,36,0.4)] hover:-translate-y-0.5 hover:shadow-[0_6px_20px_rgba(160,72,36,0.6)] transition-all duration-300 w-full md:w-auto md:min-w-[180px] disabled:opacity-50"},y(d.value?"جاري الحفظ...":"تعديل"),9,le)])],32)])])])}}};export{ye as default};
