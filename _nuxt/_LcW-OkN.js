import{_ as V}from"./BPPjlZ9P.js";import{_ as I,C as S,P as W}from"./DfAuqLDr.js";import{_ as O}from"./jlRPoBE-.js";import{_ as z}from"./3wX53bXY.js";import{b as G}from"./CyV_D5dN.js";import{G as H,a7 as J,W as Y,n as y,c as i,a as s,b as p,C as m,d as E,t as n,J as K,F as w,B as T,w as Q,r as q,m as c,o as d}from"./BrVuSVAX.js";import"./_ymiwOyQ.js";import"./DRfJZgfE.js";import"./BJD3ubJj.js";const X={class:"min-h-screen pb-20 overflow-x-hidden relative"},Z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ee={key:0,class:"mt-6 p-4 rounded-2xl bg-red-50/80 border border-red-200 text-red-700"},te={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-6"},ae={class:"w-full mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 fade-in"},se={class:"flex justify-between items-start mb-4"},oe={class:"flex flex-col items-start gap-1"},re={class:"text-[#8b7e77] text-sm"},ne={class:"text-[#5d5551] font-bold text-lg"},le={class:"flex items-start gap-3"},ie={class:"flex flex-col items-end"},ce={class:"font-bold text-[#5d5551] text-lg"},de={class:"flex items-center gap-1 text-[#9ca3af] text-xs mt-0.5"},ue={class:"w-10 h-10 rounded-lg border border-[#bf4e26]/30 flex items-center justify-center text-[#bf4e26] bg-[#bf4e26]/10"},pe={class:"flex justify-between items-end mt-2 pt-3 border-t border-[#bf4e26]/10"},me={class:"flex flex-col gap-1"},_e={class:"text-[#8b7e77] text-xs"},ge={class:"font-bold text-[#5d5551]"},fe={key:1,class:"col-span-full flex flex-col items-center justify-center py-20 text-[#8b7e77] opacity-60"},be={class:"text-lg font-medium"},je={__name:"index",async setup(ve){let g,N;const f=q("NEW"),r=q(1),k=H(),v=c(()=>({NEW:"new",PAYMENT:"waiting_for_pay",CURRENT:"current",FINISHED:"finished"})[f.value]||"new"),b=J(),D=c(()=>({status:v.value,page:r.value,tab:b.query.tab||"sent"})),L=c(()=>`orders-rent-${v.value}-${r.value}-${b.query.tab||"sent"}`),{data:B,pending:$,error:M,refresh:A}=([g,N]=Y(()=>G("/orders/rent",{query:D,watch:[v,r],server:!1,key:L})),g=await g,N(),g),P=c(()=>{const e=B.value;if(!e||typeof e!="object")return e;const o=e,l=o?.data&&typeof o.data=="object"?o.data:o,a=l?.data&&typeof l.data=="object"?l.data:l,u=a?.pagination??l?.pagination??o?.pagination;return u&&a&&typeof a=="object"&&!Array.isArray(a)&&!a.pagination?{...a,pagination:u}:a}),j=c(()=>{const e=P.value;return Array.isArray(e?.orders)&&e.orders||Array.isArray(e?.data?.orders)&&e.data.orders||Array.isArray(e)&&e||[]}),C=c(()=>{const e=P.value,o=u=>{if(!u||typeof u!="string")return null;try{const _=new URL(u).searchParams.get("page"),h=Number(_);return Number.isFinite(h)&&h>0?h:null}catch{const x=u.match(/[?&]page=(\d+)/);if(!x)return null;const _=Number(x[1]);return Number.isFinite(_)&&_>0?_:null}},l=e?.pagination?.total_pages??e?.pagination?.totalPages??e?.total_pages??e?.last_page??e?.meta?.last_page??e?.pagination?.last_page??e?.data?.last_page??(e?.total&&e?.per_page?Math.ceil(Number(e.total)/Number(e.per_page)):null)??(e?.pagination?.total_items&&e?.pagination?.per_page?Math.ceil(Number(e.pagination.total_items)/Number(e.pagination.per_page)):null)??o(e?.last_page_url)??o(e?.pagination?.next_page_url)??1,a=Number(l);return Number.isFinite(a)&&a>0?a:1}),F=c(()=>M.value?t("profile.orders.rental.loadError"):null),R=c(()=>$.value);y(()=>b.query.tab,()=>{A()}),y(f,()=>{r.value=1}),y([C,$],([e,o])=>{o||(r.value>e&&(r.value=e||1),r.value<1&&(r.value=1))});const U=e=>{f.value=e};return(e,o)=>{const l=V;return d(),i("div",X,[s("div",Z,[p(z,{items:[{label:e.$t("profile.orders.title"),to:m(k)("/profile/orders"),active:!1},{label:e.$t("profile.orders.menuItems.rental.title"),active:!0}]},null,8,["items"]),p(I,{"active-tab":f.value,onChange:U},null,8,["active-tab"]),F.value?(d(),i("div",ee,[E(n(F.value)+" ",1),s("button",{class:"underline font-semibold ms-2",onClick:o[0]||(o[0]=a=>m(A)())},n(e.$t("cards.maintenanceDetails.retry")),1)])):K("",!0),R.value?(d(),i("div",te,[(d(),i(w,null,T(6,a=>s("div",{key:a,class:"animate-pulse rounded-2xl bg-white/40 h-[150px]"})),64))])):(d(),i(w,{key:2},[s("div",ae,[j.value.length?(d(!0),i(w,{key:0},T(j.value,a=>(d(),i("div",{key:a.id??a.order_num,class:"group bg-white/40 backdrop-blur-sm border border-white/60 rounded-2xl p-5 shadow-sm hover:shadow-md hover:bg-white/60 transition-all duration-300 flex flex-col justify-between min-h-[140px]"},[s("div",se,[s("div",oe,[s("span",re,n(e.$t("cards.maintenanceDetails.serviceType"))+" :",1),s("span",ne,n(a.type_text??a.serviceType??"-"),1)]),s("div",le,[s("div",ie,[s("span",ce,n(a.order_num??a.id),1),s("div",de,[p(m(S),{class:"w-3 h-3"}),s("span",null,n(a.created_at??a.time??""),1)])]),s("div",ue,[p(m(W),{class:"w-5 h-5"})])])]),s("div",pe,[s("div",me,[s("span",_e,n(e.$t("cards.maintenanceDetails.status"))+" :",1),s("span",ge,n(a.status_text??a.status??""),1)]),p(l,{to:m(k)({path:`/profile/orders/rental/${a.id}`,query:{tab:m(b).query.tab||"sent"}}),class:"text-primary font-bold text-sm hover:underline"},{default:Q(()=>[E(n(e.$t("common.viewOrder")),1)]),_:1},8,["to"])])]))),128)):(d(),i("div",fe,[o[2]||(o[2]=s("div",{class:"w-16 h-16 mb-4 rounded-full border-2 border-dashed border-[#8b7e77] flex items-center justify-center"},[s("span",{class:"text-2xl"},"!")],-1)),s("p",be,n(e.$t("profile.orders.noOrders")),1)]))]),p(O,{page:r.value,"onUpdate:page":o[1]||(o[1]=a=>r.value=a),"total-pages":C.value},null,8,["page","total-pages"])],64))])])}}};export{je as default};
