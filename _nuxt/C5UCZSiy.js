import{_ as ge}from"./BadBXD5j.js";import{_ as ye,a4 as we,E as ke,G as $e,W as De,g as Ce,r as u,c as l,o as n,J as d,b as f,C as t,a as e,a7 as j,t as a,F as ee,B as te,A as je,w as P,M as se,O as oe,P as re,Y as ae}from"./c72oGId3.js";import{_ as Pe}from"./CDle7JFB.js";import{D as ne}from"./fKcEqTl0.js";import{c as Me,g as Ee,u as We,e as Se}from"./CRRIYHK-.js";import{u as Fe}from"./C_Rn6DEZ.js";import{b as k}from"./DACiwXMA.js";import"./DzX9AWjo.js";import"./JgLJjp22.js";import"./CzzcvkpU.js";const Oe={class:"min-h-screen pb-24 font-sans text-right relative"},qe={key:0,class:"flex items-center justify-center min-h-[60vh]"},Ie={key:1,class:"max-w-7xl mx-auto px-4 py-12 flex flex-col items-center text-center"},Ne={class:"w-20 h-20 bg-red-50 rounded-full flex items-center justify-center mb-4"},Ae={class:"text-xl font-bold text-gray-800 mb-2"},Be={class:"text-gray-500 mb-6"},Re={key:2,class:"pt-8 px-4 md:px-8 max-w-7xl mx-auto"},Te={key:0,class:"mb-6 w-[60%] mx-auto rounded-2xl p-4 text-center font-bold text-lg",style:{background:`linear-gradient(\r
            111deg,\r
            rgba(255, 255, 255, 0.21) 0%,\r
            rgba(247, 223, 170, 0.6) 100%\r
          )`,color:"var(--message-Warning, #fe9b0e)"}},Ve={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 pb-24"},Le={class:"space-y-6 lg:order-2"},Ue={class:"bg-white/40 backdrop-blur-md border border-white/60 shadow-sm rounded-2xl p-6"},ze={class:"flex justify-between items-center mb-4 border-b border-gray-200/30 pb-2"},Xe={class:"text-[#5d5551] font-bold text-lg"},Ge={class:"space-y-4"},Je={class:"flex justify-between items-center"},Ye={class:"text-[#8b7e77] text-sm"},He={class:"text-[#5d5551] font-bold font-mono"},Ke={class:"flex justify-between items-center"},Qe={class:"text-[#8b7e77] text-sm"},Ze={class:"text-[#5d5551] font-bold"},et={class:"flex justify-between items-center"},tt={class:"text-[#8b7e77] text-sm"},st={class:"text-[#5d5551] font-bold"},ot={key:0,class:"bg-white/40 backdrop-blur-md border border-white/60 shadow-sm rounded-2xl p-6"},rt={class:"flex justify-between items-center mb-4 border-b border-gray-200/30 pb-2"},at={class:"text-[#5d5551] font-bold text-lg"},nt={class:"text-[#8b7e77] text-sm leading-relaxed"},lt={class:"space-y-6 lg:order-1"},it={class:"bg-white/40 backdrop-blur-md border border-white/60 shadow-sm rounded-2xl p-6"},dt={class:"flex justify-between items-center mb-4 border-b border-gray-200/30 pb-2"},ct={class:"text-[#5d5551] font-bold text-lg"},ut={class:"space-y-4"},bt={key:0,class:"space-y-4"},mt={class:"flex justify-between items-center"},ft={class:"text-[#8b7e77] text-sm"},pt={class:"text-[#5d5551] font-bold"},ht={class:"flex justify-between items-center"},_t={class:"text-[#8b7e77] text-sm"},xt={class:"text-[#5d5551] font-bold"},vt={key:1,class:"flex justify-between items-center"},gt={class:"text-[#8b7e77] text-sm"},yt={key:2,class:"flex justify-between items-start pt-4 border-t border-[#bf4e26]/5"},wt={class:"text-[#8b7e77] text-sm"},kt={key:0,class:"bg-white/40 backdrop-blur-md border border-white/60 shadow-sm rounded-2xl p-6"},$t={class:"flex justify-between items-center mb-4 border-b border-gray-200/30 pb-2"},Dt={class:"text-[#5d5551] font-bold text-lg"},Ct={class:"flex items-center justify-between"},jt={class:"flex items-center gap-4"},Pt={class:"w-16 h-16 rounded-2xl overflow-hidden border-2 border-white shadow-md bg-white"},Mt=["src"],Et={class:"font-bold text-[#5d5551] text-lg"},Wt={key:0,class:"flex items-center gap-1 text-[#8b7e77] text-sm mt-1 dir-ltr"},St={key:1,class:"pointer-events-none"},Ft={class:"max-w-xl mx-auto px-4 pointer-events-auto flex flex-row-reverse gap-4 justify-center"},Ot={key:2,class:"flex-1 max-w-[240px] bg-[#bf4e26] text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-[#a64420] transition-all"},qt={class:"p-4"},It={class:"text-center text-gray-800 font-bold text-lg mb-6"},Nt={class:"space-y-3 mb-8 max-h-[40vh] overflow-y-auto px-1"},At=["onClick"],Bt={class:"w-5 h-5 rounded-full border border-gray-300 flex items-center justify-center p-0.5"},Rt={key:0,class:"w-full h-full bg-[#E57373] rounded-full"},Tt={class:"font-medium text-gray-700 text-right flex-1 mr-4"},Vt={class:"flex flex-col gap-3"},Lt=["disabled"],Ut={key:0,class:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"},zt={class:"p-4"},Xt={class:"text-center mb-8 border-b border-gray-200/50 pb-4"},Gt={class:"text-gray-800 font-bold text-xl"},Jt={class:"mb-6 text-right"},Yt={class:"block text-gray-700 font-bold mb-3"},Ht=["placeholder"],Kt={key:0,class:"text-red-500 text-xs mt-1 block px-2"},Qt={class:"mb-8 text-right"},Zt={class:"block text-gray-700 font-bold mb-3"},es=["placeholder"],ts=["disabled"],ss={key:0,class:"w-6 h-6 border-2 border-white/20 border-t-white rounded-full animate-spin"},os={__name:"[id]",async setup(rs){let v,M;const le=we(),{t:c}=ke();$e();const b=Fe(),g=le.params.id,{data:E,pending:ie,error:W,refresh:y}=([v,M]=De(()=>k(`/special-order-details/${g}`,{key:`special-order-${g}`})),v=await v,M(),v),o=Ce(()=>{var s;return((s=E.value)==null?void 0:s.data)||E.value}),de=(s,r)=>{s&&r&&window.open(`https://www.google.com/maps/search/?api=1&query=${s},${r}`,"_blank")},ce=Me({price:Ee().typeError(c("common.fieldRequired")).required(c("common.fieldRequired")).moreThan(0,c("common.mustBePositive"))}),{handleSubmit:ue,errors:$,resetForm:be}=We({validationSchema:ce}),{value:D}=Se("price"),p=u(!1),h=u(!1),C=u([]),m=u(null),w=u(!1),_=u(""),x=u(!1),me=()=>{be(),_.value="",w.value=!0},S=ue(async s=>{if(!x.value){x.value=!0;try{const{data:r}=await k("/orders/rent-accept-order",{method:"POST",body:{order_id:g,price:s.price,notes:_.value}});r.value&&(r.value.key==="success"||r.value.status===!0)?(w.value=!1,y(),b.success(r.value.msg||c("messages.success"))):b.error(r.value.msg||c("error.somethingWentWrong"))}catch(r){console.error("Failed to send offer",r),b.error(c("error.somethingWentWrong"))}finally{x.value=!1}}}),fe=async()=>{var s;if(C.value.length===0)try{const{data:r}=await k("/cancel-reasons");((s=r.value)==null?void 0:s.key)==="success"&&(C.value=r.value.data)}catch(r){console.error("Failed to fetch cancel reasons",r)}h.value=!0},pe=async()=>{if(!(!m.value||p.value)){p.value=!0;try{const{data:s}=await k("/orders/cancel-order",{method:"POST",body:{order_id:g,cancel_type_reason_id:m.value}});s.value&&(s.value.key==="success"||s.value.status===!0)?(h.value=!1,y(),b.success(s.value.msg||c("messages.success"))):b.error(s.value.msg||c("error.somethingWentWrong"))}catch(s){console.error("Cancel failed",s),b.error(c("error.somethingWentWrong"))}finally{p.value=!1}}};return(s,r)=>{var F,O,q,I,N,A,B,R,T,V,L,U,z,X,G,J,Y,H,K,Q;const he=j("XCircle"),_e=j("MapPin"),xe=j("Phone"),ve=ge;return n(),l("div",Oe,[t(ie)?(n(),l("div",qe,r[9]||(r[9]=[e("div",{class:"w-16 h-16 border-4 border-[#bf4e26]/10 border-t-[#bf4e26] rounded-full animate-spin"},null,-1)]))):t(W)?(n(),l("div",Ie,[e("div",Ne,[f(he,{class:"w-10 h-10 text-red-500"})]),e("h3",Ae,a(s.$t("cards.maintenanceDetails.errorTitle")),1),e("p",Be,a(t(W).message||s.$t("common.errorLoadData")),1),e("button",{onClick:r[0]||(r[0]=(...i)=>t(y)&&t(y)(...i)),class:"px-6 py-2 bg-[#bf4e26] text-white rounded-lg hover:bg-[#a64420] transition-colors"},a(s.$t("cards.maintenanceDetails.retry")),1)])):t(o)?(n(),l("div",Re,[f(Pe,{items:[{label:s.$t("profile.orders.title")||"الطلبات",to:"/profile/orders",active:!1},{label:s.$t("profile.orders.menuItems.market.title"),to:"/profile/orders/market",active:!1},{label:s.$t("cards.maintenanceDetails.title"),active:!0}],class:"mb-8"},null,8,["items"]),t(o).status==1?(n(),l("div",Te,a(s.$t("cards.maintenanceDetails.offerSentWaitingApproval")),1)):d("",!0),e("div",Ve,[e("div",Le,[e("div",Ue,[e("div",ze,[e("h3",Xe,a(s.$t("cards.maintenanceDetails.orderInfo")),1)]),e("div",Ge,[e("div",Je,[e("span",Ye,a(s.$t("cards.maintenanceDetails.orderNum")),1),e("span",He,a(t(o).order_num),1)]),e("div",Ke,[e("span",Qe,a(s.$t("cards.maintenanceDetails.status")),1),e("span",Ze,a(t(o).status_text),1)]),e("div",et,[e("span",tt,a(s.$t("cards.maintenanceDetails.serviceType")),1),e("span",st,a(t(o).type_text),1)])])]),t(o).notes?(n(),l("div",ot,[e("div",rt,[e("h3",at,a(s.$t("cards.maintenanceDetails.notes")),1)]),e("p",nt,a(t(o).notes),1)])):d("",!0)]),e("div",lt,[e("div",it,[e("div",dt,[e("h3",ct,a(s.$t("cards.maintenanceDetails.serviceInfo")),1)]),e("div",ut,[t(o).machines&&t(o).machines.length?(n(),l("div",bt,[(n(!0),l(ee,null,te(t(o).machines,(i,Z)=>(n(),l("div",{key:Z,class:"flex flex-col gap-2 border-b border-gray-100/50 last:border-0 pb-2"},[e("div",mt,[e("span",ft,a(s.$t("categories.medicalSales.specialRequestPage.deviceName")),1),e("span",pt,a(i.machine_name),1)]),e("div",ht,[e("span",_t,a(s.$t("maintenance.contracts.deviceCount")),1),e("span",xt,a(i.quantity)+" "+a(s.$t("common.device")),1)])]))),128))])):(n(),l("div",vt,[e("span",gt,a(s.$t("categories.medicalSales.specialRequestPage.deviceName")),1),r[10]||(r[10]=e("span",{class:"text-[#5d5551] font-bold"},"-",-1))])),t(o).map_desc?(n(),l("div",yt,[e("span",wt,a(s.$t("cards.maintenanceDetails.location")),1),e("div",{class:"flex items-center gap-1 text-[#bf4e26] font-bold text-left max-w-[250px] cursor-pointer hover:underline transition-all",onClick:r[1]||(r[1]=i=>de(t(o).lat,t(o).lng))},[f(_e,{class:"w-4 h-4 flex-shrink-0"}),e("span",null,a(t(o).map_desc),1)])])):d("",!0)])]),t(o).orderd_user||t(o).user||(F=t(o).providerable)!=null&&F.name||(O=t(o).provider)!=null&&O.name?(n(),l("div",kt,[e("div",$t,[e("h3",Dt,a(t(o).orderd_user||t(o).user?s.$t("cards.maintenanceDetails.customerData"):s.$t("cards.maintenanceDetails.providerDetails")),1)]),e("div",Ct,[e("div",jt,[e("div",Pt,[e("img",{src:((q=t(o).orderd_user)==null?void 0:q.image)||((I=t(o).user)==null?void 0:I.image)||((N=t(o).providerable)==null?void 0:N.image)||((A=t(o).provider)==null?void 0:A.image)||"https://placehold.co/100x100?text=User",class:"w-full h-full object-cover",onError:r[2]||(r[2]=i=>i.target.src="https://placehold.co/100x100?text=User")},null,40,Mt)]),e("div",null,[e("h4",Et,a(((B=t(o).orderd_user)==null?void 0:B.name)||((R=t(o).user)==null?void 0:R.name)||((T=t(o).providerable)==null?void 0:T.name)||((V=t(o).provider)==null?void 0:V.name)),1),(L=t(o).orderd_user)!=null&&L.phone||(U=t(o).user)!=null&&U.phone||(z=t(o).providerable)!=null&&z.phone?(n(),l("div",Wt,[f(xe,{class:"w-3.5 h-3.5"}),e("span",null,a(((X=t(o).orderd_user)==null?void 0:X.phone)||((G=t(o).user)==null?void 0:G.phone)||((J=t(o).providerable)==null?void 0:J.phone)),1)])):d("",!0)])]),(Y=t(o).providerable)!=null&&Y.room_id||(H=t(o).buttons)!=null&&H.room_id?(n(),je(ve,{key:0,to:{path:"/profile/chat",query:{roomId:((K=t(o).providerable)==null?void 0:K.room_id)||((Q=t(o).buttons)==null?void 0:Q.room_id)}},class:"flex items-center gap-2 bg-[#EADFD8] text-[#8C6B5D] px-4 py-2 rounded-lg hover:bg-[#E0D0C5] transition-colors text-sm font-bold shadow-sm border border-[#DCCAC0]"},{default:P(()=>[e("span",null,a(s.$t("cards.maintenanceDetails.chat")),1)]),_:1},8,["to"])):d("",!0)])])):d("",!0)])]),t(o).buttons?(n(),l("div",St,[e("div",Ft,[t(o).buttons.accept_order&&!t(o).buttons.has_offer?(n(),l("button",{key:0,onClick:me,class:"flex-1 max-w-[240px] background-btn text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-[#5a3f34] transition-all"},a(s.$t("cards.maintenanceDetails.addOffer")),1)):d("",!0),t(o).buttons.cancel?(n(),l("button",{key:1,onClick:fe,class:"flex-1 max-w-[240px] bg-transparent border-2 border-[#EC2D30] text-[#EC2D30] py-4 rounded-xl font-bold text-lg hover:bg-red-50 transition-all shadow-md"},a(s.$t("cards.maintenanceDetails.reject")),1)):d("",!0),t(o).buttons.contact_with_admin?(n(),l("button",Ot,a(s.$t("cards.maintenanceDetails.contactWithAdmin")),1)):d("",!0)])])):d("",!0)])):d("",!0),f(ne,{visible:t(h),position:"bottom",width:"450px",onClose:r[4]||(r[4]=i=>h.value=!1)},{default:P(()=>[e("div",qt,[e("h3",It,a(s.$t("cancelModal.title")),1),e("div",Nt,[(n(!0),l(ee,null,te(t(C),i=>(n(),l("div",{key:i.id,onClick:Z=>m.value=i.id,class:se(["flex items-center justify-between p-4 rounded-xl cursor-pointer transition-all border group bg-white/50",t(m)===i.id?"border-[#E57373] ring-1 ring-[#E57373]/20":"border-transparent hover:bg-white/80"])},[e("div",Bt,[t(m)===i.id?(n(),l("div",Rt)):d("",!0)]),e("span",Tt,a(i.name),1)],10,At))),128))]),e("div",Vt,[e("button",{onClick:pe,disabled:!t(m)||t(p),class:"w-full bg-[#E57373] text-white py-4 rounded-2xl font-bold text-lg shadow-lg hover:bg-[#d45d5d] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[t(p)?(n(),l("div",Ut)):d("",!0),e("span",null,a(s.$t("cancelModal.confirm")),1)],8,Lt),e("button",{onClick:r[3]||(r[3]=i=>h.value=!1),class:"w-full bg-white text-gray-500 py-4 rounded-2xl font-bold text-lg hover:bg-gray-50 transition-colors border border-gray-100"},a(s.$t("cancelModal.cancel")),1)])])]),_:1},8,["visible"]),f(ne,{visible:t(w),position:"bottom",width:"450px",onClose:r[8]||(r[8]=i=>w.value=!1)},{default:P(()=>[e("div",zt,[e("div",Xt,[e("h3",Gt,a(s.$t("cards.maintenanceDetails.offerDetails")),1)]),e("div",Jt,[e("label",Yt,a(s.$t("cards.maintenanceDetails.offerPrice")),1),oe(e("input",{"onUpdate:modelValue":r[5]||(r[5]=i=>ae(D)?D.value=i:null),type:"number",placeholder:s.$t("cards.maintenanceDetails.offerPrice"),class:se(["w-full p-4 rounded-xl border bg-white/80 text-right focus:outline-none transition-all font-bold text-lg",t($).price?"border-red-500 focus:ring-red-500/20":"border-gray-100 focus:ring-[#bf4e26]/20"])},null,10,Ht),[[re,t(D)]]),t($).price?(n(),l("span",Kt,a(t($).price),1)):d("",!0)]),e("div",Qt,[e("label",Zt,a(s.$t("cards.maintenanceDetails.notes")||"الملاحظات"),1),oe(e("textarea",{"onUpdate:modelValue":r[6]||(r[6]=i=>ae(_)?_.value=i:null),rows:"4",placeholder:s.$t("cards.maintenanceDetails.notes")||"اضف ملاحظاتك هنا...",class:"w-full p-4 rounded-xl border border-gray-100 bg-white/80 text-right focus:outline-none focus:ring-2 focus:ring-[#bf4e26]/20 transition-all resize-none"},null,8,es),[[re,t(_)]])]),e("button",{onClick:r[7]||(r[7]=(...i)=>t(S)&&t(S)(...i)),disabled:t(x),class:"w-full background-btn text-white py-4 rounded-2xl font-bold text-xl shadow-lg hover:bg-[#5a3f34] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[t(x)?(n(),l("div",ss)):d("",!0),e("span",null,a(s.$t("common.send")),1)],8,ts)])]),_:1},8,["visible"])])}}},hs=ye(os,[["__scopeId","data-v-969efee3"]]);export{hs as default};
