import{_ as Y}from"./C9Z1dL1Q.js";import{E as Z,a0 as ee,W as te,G as se,N as ae,c as u,a as s,b as r,C as t,M as y,t as n,w as p,T as g,F as j,B as z,S as ie,r as C,m as le,o as m}from"./3xVLZ2qR.js";import{c as oe,f as re,b as w,g as k,u as ne,F as d,E as c}from"./BV6_dk4t.js";import{_ as de}from"./BbLLT3xF.js";import{u as ce,b as ue}from"./CSoW_MW-.js";import{u as pe}from"./AlwKQ0U4.js";import{M as me}from"./EzygixSb.js";import{C as ve}from"./itcCnCPa.js";import"./DcEVD5g_.js";import"./BSXfmHdH.js";import"./CbMxxevO.js";import"./BAccf7o5.js";const xe={class:"min-h-screen w-full relative overflow-hidden p-6 sm:p-10"},he={class:"w-full max-w-2xl mx-auto mb-6"},fe={class:"w-full max-w-2xl bg-white/40 backdrop-blur-md rounded-[2.5rem] p-6 md:p-10 border border-white/60 mx-auto z-10 shadow-xl"},ge={class:"flex justify-start mb-8"},be={class:"bg-white/50 p-1.5 rounded-2xl flex items-center relative w-48 shadow-sm border border-white/60"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ye={class:"flex flex-col gap-2"},we={class:"text-xs font-bold opacity-70"},ke=["placeholder"],qe={class:"flex flex-col gap-2"},Ce={class:"text-xs font-bold opacity-70"},Ee=["placeholder","dir"],Ae={class:"flex flex-col gap-2"},Le={class:"text-xs font-bold opacity-70"},De={disabled:"",value:""},Fe=["value"],Ne={class:"flex flex-col gap-2"},Ie={class:"text-xs font-bold opacity-70"},$e={disabled:"",value:""},Me={value:1},Be={value:0},Se={class:"flex flex-col gap-2"},je={class:"text-xs font-bold opacity-70"},ze=["placeholder"],Pe={class:"flex flex-col gap-2"},Ue={class:"text-xs font-bold opacity-70"},Re=["placeholder"],Oe={class:"flex flex-col gap-2"},Te={class:"text-xs font-bold opacity-70"},Ve=["onChange"],We={key:0,class:"grid grid-cols-3 gap-2 w-full"},Ge=["src"],He=["onClick"],Je={key:1,class:"text-gray-500 group-hover:text-brand-primary flex flex-col items-center"},Ke={class:"text-xs"},Qe={class:"flex flex-col gap-2"},Xe={class:"text-xs font-bold opacity-70"},Ye=["placeholder"],Ze={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},et={class:"flex flex-col gap-2"},tt={class:"text-xs font-bold opacity-70"},st=["value","onInput","onBlur","placeholder"],at={class:"flex flex-col gap-2"},it={class:"text-xs font-bold opacity-70"},lt=["value","onInput","onBlur","placeholder","dir"],ot={class:"pt-4 border-t border-gray-200/20"},rt={class:"flex flex-col gap-2"},nt={class:"text-xs font-bold opacity-70"},dt={class:"flex items-center gap-2 overflow-hidden"},ct={key:0,class:"text-gray-700 truncate"},ut={key:1,class:"text-gray-400"},pt={class:"flex flex-col gap-2 mt-4"},mt={class:"text-xs font-bold opacity-70"},vt=["placeholder"],xt={class:"pt-4"},ht=["disabled"],ft={key:0},gt={key:1},q="w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-1 focus:ring-brand-primary/50 focus:bg-white/60 transition-all placeholder:text-gray-400",P="w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-1 focus:ring-brand-primary/50 focus:bg-white/60 transition-all text-gray-700",U="w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-1 focus:ring-brand-primary/50 focus:bg-white/60 transition-all placeholder:text-gray-400 resize-none",x="border-red-500/50 focus:ring-red-500/20 bg-red-50/50",$t={__name:"add-device",async setup(bt){let E,F;const{t:e}=Z(),R=oe({titleAr:w().trim().required(e("validation.required")).min(3,e("validation.min",{min:3})).max(100,e("validation.max",{max:100})).label(e("devices.nameAr")),titleEn:w().trim().required(e("validation.required")).min(3,e("validation.min",{min:3})).max(100,e("validation.max",{max:100})).label(e("devices.nameEn")),supplierName:w().trim().required(e("validation.required")).max(100,e("validation.max",{max:100})).label(e("devices.supplier")),deviceClassId:k().transform((i,a)=>a===""?void 0:i).required(e("validation.required")).label(e("devices.class")),isNew:k().required(e("validation.required")).oneOf([0,1],e("validation.invalid_value")).label(e("devices.condition")),quantity:k().transform((i,a)=>a===""?void 0:i).typeError(e("validation.number")).required(e("validation.required")).min(1,e("validation.minNumber",{min:1})).label(e("devices.quantityLabel")),lat:k().transform((i,a)=>a===""?void 0:i).typeError(e("validation.number")).required(e("validation.required")).label(e("devices.lat")),lng:k().transform((i,a)=>a===""?void 0:i).typeError(e("validation.number")).required(e("validation.required")).label(e("devices.lng")),mapDesc:w().required(e("validation.required")).label(e("devices.locationDesc")),price:k().transform((i,a)=>a===""?void 0:i).typeError(e("validation.number")).required(e("validation.required")).positive(e("validation.positive")).min(.01,e("validation.minNumber",{min:.01})).label(e("devices.priceLabel")),descriptionAr:w().trim().required(e("validation.required")).max(1e3,e("validation.max",{max:1e3})).label(e("devices.descAr")),descriptionEn:w().trim().required(e("validation.required")).max(1e3,e("validation.max",{max:1e3})).label(e("devices.descEn")),images:re().min(1,e("validation.at_least_one_image")).required(e("validation.required")).test("fileType",e("validation.image_files_only"),i=>!i||i.length===0?!0:i.every(a=>a instanceof File&&a.type.startsWith("image/"))).test("fileSize",e("validation.file_size_limit"),i=>!i||i.length===0?!0:i.every(a=>a.size<=5*1024*1024)).label(e("devices.images"))}),{handleSubmit:O,setFieldValue:L,resetForm:T,values:h,errors:N}=ne({validationSchema:R,initialValues:{titleAr:"",titleEn:"",supplierName:"",deviceClassId:"",isNew:1,quantity:"",lat:"",lng:"",mapDesc:"",price:"",descriptionAr:"",descriptionEn:"",images:[]}}),_=C("sale"),D=C(!1),V=i=>{L("lat",i.lat),L("lng",i.lng),L("mapDesc",i.address)};ee(()=>{T(),_.value="sale",v.value.forEach(i=>URL.revokeObjectURL(i)),v.value=new Map});const{data:W}=([E,F]=te(()=>ue("/device-classes")),E=await E,F(),E),G=le(()=>(W.value?.data||[]).map(a=>({value:a.id,label:a.name}))),I=C(null),v=C(new Map);function H(){I.value.click()}function J(i,a){const f=Array.from(i.target.files||[]);f.length&&(f.forEach(l=>{if(!v.value.has(l)){const o=URL.createObjectURL(l);v.value.set(l,o)}}),a(Array.from(v.value.keys())))}function K(i,a){const f=v.value.get(i);f&&URL.revokeObjectURL(f),v.value.delete(i),a(Array.from(v.value.keys()))}function $(i){return _.value==="sale"&&i==="sale"||_.value==="rent"&&i==="rent"?"flex-1 py-1.5 text-sm font-bold rounded-xl bg-[#8F300E] text-white shadow-md transition-all":"flex-1 py-1.5 text-sm font-bold rounded-xl text-gray-500 hover:bg-white/40 transition-all"}const{upload:Q}=ce(),A=C(!1),M=pe(),X=se(),B=O(async i=>{A.value=!0;try{const a=new FormData;a.append("title[ar]",i.titleAr),a.append("title[en]",i.titleEn),a.append("supplier_name",i.supplierName),a.append("price",i.price),a.append("device_class_id",i.deviceClassId),a.append("is_new",i.isNew),a.append("quantity",i.quantity),a.append("type",_.value),a.append("description[ar]",i.descriptionAr),a.append("description[en]",i.descriptionEn),a.append("lat",i.lat),a.append("lng",i.lng),a.append("map_desc",i.mapDesc),i.images&&i.images.length&&i.images.forEach(l=>{a.append("images[]",l)}),console.log("Submitting FormData...");const f=await Q("/store-machine",a);M.success(e("messages.success")),ae(X("/profile/more/devices"))}catch(a){console.error("Error adding device:",a),M.error(a.error||e("error.somethingWentWrong"))}finally{A.value=!1}});return(i,a)=>{const f=Y;return m(),u("div",xe,[s("div",he,[r(f,{items:[{label:t(e)("profile.more.menuItems.market"),to:"/profile/more",active:!1},{label:t(e)("devices.breadcrumb.devices"),to:"/profile/more/devices",active:!1},{label:t(e)("devices.addDevice"),to:"/profile/more/devices/add-device",active:!0}],direction:i.$i18n.locale==="ar"?"rtl":"ltr"},null,8,["items","direction"])]),s("div",fe,[s("div",ge,[s("div",be,[s("button",{type:"button",onClick:a[0]||(a[0]=l=>_.value="sale"),class:y($("sale"))},n(t(e)("devices.sale")),3),s("button",{type:"button",onClick:a[1]||(a[1]=l=>_.value="rent"),class:y($("rent"))},n(t(e)("devices.rent")),3)])]),s("form",{onSubmit:a[4]||(a[4]=(...l)=>t(B)&&t(B)(...l)),class:"space-y-4"},[s("div",_e,[s("div",ye,[s("label",we,n(t(e)("devices.nameAr")),1),r(t(d),{name:"titleAr"},{default:p(({field:l,meta:o})=>[s("input",g(l,{placeholder:t(e)("devices.nameArPlaceholder"),class:[q,o.touched&&o.invalid&&x]}),null,16,ke)]),_:1}),r(t(c),{name:"titleAr",class:"text-red-500 text-xs pr-1"})]),s("div",qe,[s("label",Ce,n(t(e)("devices.nameEn")),1),r(t(d),{name:"titleEn"},{default:p(({field:l,meta:o})=>[s("input",g(l,{placeholder:t(e)("devices.nameEn"),dir:l.value?"ltr":i.$i18n.locale==="ar"?"rtl":"ltr",class:[q,o.touched&&o.invalid&&x]}),null,16,Ee)]),_:1}),r(t(c),{name:"titleEn",class:"text-red-500 text-xs pr-1 block text-right"})])]),s("div",Ae,[s("label",Le,n(t(e)("devices.class")),1),r(t(d),{name:"deviceClassId"},{default:p(({field:l,meta:o})=>[s("select",g(l,{class:[P,o.touched&&o.invalid&&x]}),[s("option",De,n(t(e)("devices.selectClass")),1),(m(!0),u(j,null,z(G.value,b=>(m(),u("option",{key:b.value,value:b.value},n(b.label),9,Fe))),128))],16)]),_:1}),r(t(c),{name:"deviceClassId",class:"text-red-500 text-xs pr-1"})]),s("div",Ne,[s("label",Ie,n(t(e)("devices.condition")),1),r(t(d),{name:"isNew"},{default:p(({field:l,meta:o})=>[s("select",g(l,{class:[P,o.touched&&o.invalid&&x]}),[s("option",$e,n(t(e)("devices.selectCondition")),1),s("option",Me,n(t(e)("devices.new")),1),s("option",Be,n(t(e)("devices.used")),1)],16)]),_:1}),r(t(c),{name:"isNew",class:"text-red-500 text-xs pr-1"})]),s("div",Se,[s("label",je,n(t(e)("devices.quantityLabel")),1),r(t(d),{name:"quantity"},{default:p(({field:l,meta:o})=>[s("input",g(l,{type:"number",placeholder:t(e)("devices.quantityLabel"),class:[q,o.touched&&o.invalid&&x]}),null,16,ze)]),_:1}),r(t(c),{name:"quantity",class:"text-red-500 text-xs pr-1"})]),s("div",Pe,[s("label",Ue,n(t(e)("devices.supplier")),1),r(t(d),{name:"supplierName"},{default:p(({field:l,meta:o})=>[s("input",g(l,{placeholder:t(e)("devices.supplierPlaceholder"),class:[q,o.touched&&o.invalid&&x]}),null,16,Re)]),_:1}),r(t(c),{name:"supplierName",class:"text-red-500 text-xs pr-1"})]),s("div",Oe,[s("label",Te,n(t(e)("devices.images")),1),r(t(d),{name:"images"},{default:p(({field:l,meta:o})=>[s("div",{onClick:H,class:y(["w-full bg-white/40 min-h-[6rem] rounded-xl border-2 border-dashed border-gray-400/30 flex flex-col items-center justify-center cursor-pointer hover:bg-white/60 transition overflow-hidden relative group p-4",[o.touched&&o.invalid&&"border-red-500/50"]])},[s("input",{type:"file",ref_key:"fileInput",ref:I,class:"hidden",accept:"image/*",multiple:"",onChange:b=>J(b,l.onChange)},null,40,Ve),v.value.size>0?(m(),u("div",We,[(m(!0),u(j,null,z(v.value,([b,S])=>(m(),u("div",{key:S,class:"relative aspect-square rounded-lg overflow-hidden border border-black/10 group/img"},[s("img",{src:S,class:"w-full h-full object-cover"},null,8,Ge),s("button",{type:"button",onClick:ie(_t=>K(b,l.onChange),["stop"]),class:"absolute top-1 right-1 bg-red-500/80 hover:bg-red-600 text-white p-1 rounded-full opacity-0 group-hover/img:opacity-100 transition-all transform hover:scale-110 shadow-lg z-20"},[...a[5]||(a[5]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,He)]))),128)),a[6]||(a[6]=s("div",{class:"flex items-center justify-center text-xs text-brand-primary font-bold bg-white/50 rounded-lg"}," + ",-1))])):(m(),u("div",Je,[a[7]||(a[7]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-2 opacity-60",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),s("span",Ke,n(t(e)("devices.uploadImages")),1)]))],2)]),_:1}),r(t(c),{name:"images",class:"text-red-500 text-xs pr-1"})]),s("div",Qe,[s("label",Xe,n(t(e)("devices.priceLabel")),1),r(t(d),{name:"price"},{default:p(({field:l,meta:o})=>[s("input",g(l,{type:"number",placeholder:t(e)("devices.priceLabel"),class:[q,o.touched&&o.invalid&&x]}),null,16,Ye)]),_:1}),r(t(c),{name:"price",class:"text-red-500 text-xs pr-1"})]),s("div",Ze,[s("div",et,[s("label",tt,n(t(e)("devices.descAr")),1),r(t(d),{name:"descriptionAr"},{default:p(({field:l,meta:o})=>[s("textarea",{value:l.value,onInput:l.onChange,onBlur:l.onBlur,placeholder:t(e)("devices.descArPlaceholder"),rows:"4",class:y([U,o.touched&&o.invalid&&x])},null,42,st)]),_:1}),r(t(c),{name:"descriptionAr",class:"text-red-500 text-xs pr-1"})]),s("div",at,[s("label",it,n(t(e)("devices.descEn")),1),r(t(d),{name:"descriptionEn"},{default:p(({field:l,meta:o})=>[s("textarea",{value:l.value,onInput:l.onChange,onBlur:l.onBlur,placeholder:t(e)("devices.descEn"),dir:l.value?"ltr":i.$i18n.locale==="ar"?"rtl":"ltr",rows:"4",class:y([U,o.touched&&o.invalid&&x])},null,42,lt)]),_:1}),r(t(c),{name:"descriptionEn",class:"text-red-500 text-xs pr-1 block text-right"})])]),s("div",ot,[s("div",rt,[s("label",nt,n(t(e)("devices.location")),1),s("div",{onClick:a[2]||(a[2]=l=>D.value=!0),class:y(["w-full bg-white/40 border border-gray-100/50 rounded-xl px-4 py-3 text-sm cursor-pointer hover:bg-white/60 transition-all flex items-center justify-between group",[t(N).lat||t(N).lng?"border-red-500/50 bg-red-50/50":""]])},[s("div",dt,[r(t(me),{class:"w-4 h-4 text-[#8F300E] shrink-0"}),t(h).lat&&t(h).lng?(m(),u("span",ct,n(t(h).mapDesc||`${t(h).lat}, ${t(h).lng}`),1)):(m(),u("span",ut,n(t(e)("devices.selectLocationOnMap")),1))]),r(t(ve),{class:"w-4 h-4 text-gray-400 group-hover:text-[#8F300E] transition-colors"})],2),r(t(d),{name:"lat",type:"hidden"}),r(t(d),{name:"lng",type:"hidden"}),r(t(c),{name:"lat",class:"text-red-500 text-xs pr-1"})]),s("div",pt,[s("label",mt,n(t(e)("devices.locationDesc")),1),r(t(d),{name:"mapDesc"},{default:p(({field:l,meta:o})=>[s("input",g(l,{placeholder:t(e)("devices.locationPlaceholder"),class:[q,o.touched&&o.invalid&&x]}),null,16,vt)]),_:1}),r(t(c),{name:"mapDesc",class:"text-red-500 text-xs pr-1"})])]),r(de,{"is-open":D.value,"initial-lat":t(h).lat?Number(t(h).lat):24.7136,"initial-lng":t(h).lng?Number(t(h).lng):46.6753,onClose:a[3]||(a[3]=l=>D.value=!1),onLocationSelected:V},null,8,["is-open","initial-lat","initial-lng"]),s("div",xt,[s("button",{type:"submit",class:"w-full py-4 text-white font-bold text-lg rounded-xl shadow-lg bg-gradient-to-r from-[#8F300E] to-[#D2592D] hover:shadow-xl hover:scale-[1.01] transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:A.value},[A.value?(m(),u("span",ft,n(t(e)("devices.adding")),1)):(m(),u("span",gt,n(t(e)("devices.addDevice")),1))],8,ht)])],32)]),a[8]||(a[8]=s("div",{class:"fixed inset-0 pointer-events-none -z-10 bg-[#E8E0DA]/30"},[s("div",{class:"absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-[#D2592D]/5 rounded-full blur-[120px]"}),s("div",{class:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-[#8F300E]/10 rounded-full blur-[100px]"})],-1))])}}};export{$t as default};
