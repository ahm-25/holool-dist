import{_ as V}from"./DuLWEyxR.js";import{_ as j}from"./e2BhSMQC.js";import{_ as z}from"./CeUndfFE.js";import{D as H}from"./W7208tLg.js";import{b as _}from"./DgXYbC5v.js";import{_ as W,a7 as G,W as J,H as X,G as K,c as r,C as d,a as e,b,t as s,F as w,B as y,J as i,A as Q,w as M,M as U,m as Y,r as c,o as n}from"./DxUUb53P.js";import{u as Z}from"./DHC15DRf.js";import{C as ee}from"./BkwfCSYq.js";import{M as te}from"./DHUTj43j.js";import{S as se}from"./BnTByfgg.js";import{c as oe}from"./B_Y3DPK4.js";import"./C7xbsjf1.js";import"./BT8WpdOU.js";const ae=oe("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),le={class:"min-h-screen pb-24 font-sans text-right relative"},ne={key:0,class:"flex items-center justify-center min-h-[60vh]"},re={key:1,class:"max-w-7xl mx-auto px-4 py-12 flex flex-col items-center text-center"},ie={class:"w-20 h-20 bg-red-50 rounded-full flex items-center justify-center mb-4"},de={class:"text-xl font-bold text-gray-800 mb-2"},ce={class:"text-gray-500 mb-6"},ue={key:2,class:"pt-8 px-4 md:px-8 max-w-7xl mx-auto"},be={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 pb-24"},he={class:"space-y-6 lg:order-2"},me={class:"bg-white/40 backdrop-blur-md border border-white/60 shadow-sm rounded-2xl p-6"},fe={class:"flex justify-between items-center mb-4 border-b border-gray-200/30 pb-2"},ve={class:"text-[#5d5551] font-bold text-lg"},pe={class:"space-y-4"},_e={class:"flex justify-between items-center"},xe={class:"text-[#8b7e77] text-sm"},ge={class:"text-[#5d5551] font-bold font-mono"},we={class:"flex justify-between items-center"},ye={class:"text-[#8b7e77] text-sm"},ke={class:"text-[#5d5551] font-bold"},$e={class:"flex justify-between items-center"},Ce={class:"text-[#8b7e77] text-sm"},De={class:"text-[#5d5551] font-bold"},je={class:"flex justify-between items-start pt-2"},Me={class:"text-[#8b7e77] text-sm"},Ee={class:"bg-white/40 backdrop-blur-md border border-white/60 shadow-sm rounded-2xl p-6"},Pe={class:"flex justify-between items-center mb-4 border-b border-gray-200/30 pb-2"},Se={class:"text-[#5d5551] font-bold text-lg"},Ae={class:"text-[#8b7e77] text-sm leading-relaxed min-h-[60px]"},Fe={class:"space-y-6 lg:order-1"},Ie={class:"bg-white/40 backdrop-blur-md border border-white/60 shadow-sm rounded-2xl p-6"},Ne={class:"flex justify-between items-center mb-4 border-b border-gray-200/30 pb-2"},qe={class:"text-[#5d5551] font-bold text-lg"},Be={key:0,class:"space-y-6"},Le={class:"flex items-start justify-between"},Oe={class:"flex items-center gap-4"},Te={class:"w-20 h-20 rounded-xl overflow-hidden border border-white bg-white shadow-sm"},Re=["src"],Ve={class:"font-bold text-[#5d5551] text-lg"},ze={class:"text-[#8b7e77] text-sm mt-1"},He={class:"mt-2 flex items-baseline gap-1 text-[#bf4e26]"},We={class:"font-bold text-xl"},Ge={class:"text-right"},Je={class:"text-[#8b7e77] text-sm"},Xe={class:"font-bold text-[#5d5551] block"},Ke={key:1,class:"flex flex-col gap-4"},Qe={class:"flex items-start justify-between"},Ue={class:"flex items-center gap-4"},Ye={class:"w-20 h-20 rounded-xl overflow-hidden border border-white bg-white shadow-sm"},Ze=["src"],et={class:"font-bold text-[#5d5551] text-lg"},tt={class:"text-[#8b7e77] text-sm mt-1"},st={class:"mt-2 flex items-baseline gap-1 text-[#bf4e26]"},ot={class:"font-bold text-xl"},at={class:"text-right"},lt={class:"text-[#8b7e77] text-sm"},nt={class:"font-bold text-[#5d5551] block"},rt={key:0,class:"bg-white/40 backdrop-blur-md border border-white/60 shadow-sm rounded-2xl p-6"},it={class:"flex justify-between items-center mb-4 border-b border-gray-200/30 pb-2"},dt={class:"text-[#5d5551] font-bold text-lg"},ct={class:"flex items-center justify-between"},ut={class:"flex items-center gap-4"},bt={class:"w-16 h-16 rounded-2xl overflow-hidden border-2 border-white shadow-md bg-white"},ht=["src"],mt={class:"font-bold text-[#5d5551] text-lg"},ft={class:"flex text-yellow-400 text-xs mt-1"},vt={key:0,class:"fixed bottom-8 left-0 right-0 z-40"},pt={class:"max-w-7xl mx-auto px-4 flex justify-center gap-4 flex-wrap"},_t={key:0,class:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"},xt=["disabled"],gt={key:0,class:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"},wt={key:4,class:"min-w-[200px] bg-[#5d5551] text-white py-4 rounded-2xl font-bold text-lg hover:bg-[#4a4441] transition-all shadow-lg"},yt={class:"p-4"},kt={class:"text-center text-gray-800 font-bold text-lg mb-6"},$t={class:"space-y-3 mb-8 max-h-[40vh] overflow-y-auto px-1"},Ct=["onClick"],Dt={class:"w-5 h-5 rounded-full border border-gray-300 flex items-center justify-center p-0.5"},jt={key:0,class:"w-full h-full bg-[#E57373] rounded-full"},Mt={class:"font-medium text-gray-700 text-right flex-1 mr-4"},Et={class:"flex flex-col gap-3"},Pt=["disabled"],St={key:0,class:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"},At={__name:"[id]",async setup(Ft){let v,k;const p=G().params.id,{data:$,pending:E,error:C,refresh:x}=([v,k]=J(()=>_(`/orders/cart-details/${p}`,{key:`cart-order-${p}`})),v=await v,k(),v),o=Y(()=>$.value?.data||$.value),P=(t,l)=>{t&&l&&window.open(`https://www.google.com/maps/search/?api=1&query=${t},${l}`,"_blank")},h=c(!1),m=c(!1),g=c([]),u=c(null),S=X(),A=K(),F=Z(),f=c(!1),I=async()=>{if(!f.value){f.value=!0;try{const{data:t}=await _("/orders/finish-order",{method:"POST",body:{order_id:p}});t.value&&(t.value.key==="success"||t.value.status===!0)&&(F.success(t.value.msg),S.push(A("/profile/orders/market")))}catch(t){console.error("Finish failed",t)}finally{f.value=!1}}},N=c(!1),q=()=>{console.log("Open payment modal")},B=c(!1),L=async()=>{if(g.value.length===0)try{const{data:t}=await _("/cancel-reasons");t.value?.key==="success"&&(g.value=t.value.data)}catch(t){console.error("Failed to fetch cancel reasons",t)}m.value=!0},O=async()=>{if(!(!u.value||h.value)){h.value=!0;try{const{data:t}=await _("/orders/cancel-order",{method:"POST",body:{order_id:p,cancel_type_reason_id:u.value}});t.value&&(t.value.key==="success"||t.value.status===!0)&&(m.value=!1,x())}catch(t){console.error("Cancel failed",t)}finally{h.value=!1}}};return(t,l)=>{const T=V;return n(),r("div",le,[d(E)?(n(),r("div",ne,[...l[8]||(l[8]=[e("div",{class:"w-16 h-16 border-4 border-[#bf4e26]/10 border-t-[#bf4e26] rounded-full animate-spin"},null,-1)])])):d(C)?(n(),r("div",re,[e("div",ie,[b(d(ee),{class:"w-10 h-10 text-red-500"})]),e("h3",de,s(t.$t("cards.maintenanceDetails.errorTitle")),1),e("p",ce,s(d(C).message||t.$t("common.errorLoadData")),1),e("button",{onClick:l[0]||(l[0]=(...a)=>d(x)&&d(x)(...a)),class:"px-6 py-2 bg-[#bf4e26] text-white rounded-lg hover:bg-[#a64420] transition-colors"},s(t.$t("cards.maintenanceDetails.retry")),1)])):o.value?(n(),r("div",ue,[b(z,{items:[{label:t.$t("profile.orders.title"),to:"/profile/orders",active:!1},{label:t.$t("categories.medicalSales.title"),to:"/profile/orders/market",active:!1},{label:t.$t("cards.maintenanceDetails.title"),active:!0}],class:"mb-8"},null,8,["items"]),e("div",be,[e("div",he,[e("div",me,[e("div",fe,[e("h3",ve,s(t.$t("cards.maintenanceDetails.orderInfo")),1)]),e("div",pe,[e("div",_e,[e("span",xe,s(t.$t("cards.maintenanceDetails.orderNum")),1),e("span",ge,s(o.value.order_num??o.value.id),1)]),e("div",we,[e("span",ye,s(t.$t("cards.maintenanceDetails.status")),1),e("span",ke,s(o.value.status_text),1)]),e("div",$e,[e("span",Ce,s(t.$t("cards.maintenanceDetails.serviceType")),1),e("span",De,s(o.value.type_text??t.$t("categories.medicalSales.title")),1)]),e("div",je,[e("span",Me,s(t.$t("cards.maintenanceDetails.location")),1),e("div",{class:"flex items-center gap-1 text-[#bf4e26] font-bold text-left max-w-[250px] cursor-pointer hover:underline transition-all",onClick:l[1]||(l[1]=a=>P(o.value.lat,o.value.lng))},[b(d(te),{class:"w-4 h-4 flex-shrink-0"}),e("span",null,s(o.value.map_desc??"-"),1)])])])]),e("div",Ee,[e("div",Pe,[e("h3",Se,s(t.$t("cards.maintenanceDetails.notes")),1)]),e("p",Ae,s(o.value.notes||t.$t("common.noNotes")),1)])]),e("div",Fe,[e("div",Ie,[e("div",Ne,[e("h3",qe,s(t.$t("cards.maintenanceDetails.deviceInfo")),1)]),o.value.order_machines?.length||o.value.machines?.length?(n(),r("div",Be,[(n(!0),r(w,null,y(o.value.order_machines||o.value.machines,(a,D)=>(n(),r("div",{key:D,class:"flex flex-col gap-4"},[e("div",Le,[e("div",Oe,[e("div",Te,[e("img",{src:a.machine_image||a.image,class:"w-full h-full object-cover",onError:l[2]||(l[2]=R=>R.target.src="https://placehold.co/200?text=Device")},null,40,Re)]),e("div",null,[e("h4",Ve,s(a.machine_title||a.machine_name||a.title),1),e("p",ze,s(t.$t("maintenance.contracts.deviceClass"))+": "+s(a.machine_class_text||"-"),1),e("div",He,[e("span",We,s(a.price),1),l[9]||(l[9]=e("img",{src:j,alt:"sar",class:"w-4 h-4 object-contain"},null,-1))])])]),e("div",Ge,[e("span",Je,s(t.$t("maintenance.contracts.deviceCount"))+":",1),e("span",Xe,s(a.quantity),1)])])]))),128))])):o.value.machine?(n(),r("div",Ke,[e("div",Qe,[e("div",Ue,[e("div",Ye,[e("img",{src:o.value.machine.image,class:"w-full h-full object-cover",onError:l[3]||(l[3]=a=>a.target.src="https://placehold.co/200?text=Device")},null,40,Ze)]),e("div",null,[e("h4",et,s(o.value.machine.title),1),e("p",tt,s(t.$t("maintenance.contracts.deviceClass"))+": "+s(o.value.machine.device_class||"-"),1),e("div",st,[e("span",ot,s(o.value.machine.price),1),l[10]||(l[10]=e("img",{src:j,alt:"sar",class:"w-4 h-4 object-contain"},null,-1))])])]),e("div",at,[e("span",lt,s(t.$t("maintenance.contracts.deviceCount"))+":",1),e("span",nt,s(o.value.quantity||1),1)])])])):i("",!0)]),o.value.provider||o.value.providerable?(n(),r("div",rt,[e("div",it,[e("h3",dt,s(t.$t("cards.maintenanceDetails.providerDetails")),1)]),e("div",ct,[e("div",ut,[e("div",bt,[e("img",{src:o.value.provider?.image||o.value.providerable?.image,class:"w-full h-full object-cover",onError:l[4]||(l[4]=a=>a.target.src="https://placehold.co/100x100?text=Provider")},null,40,ht)]),e("div",null,[e("h4",mt,s(o.value.provider?.name||o.value.providerable?.name),1),e("div",ft,[(n(),r(w,null,y(5,a=>b(d(se),{key:a,class:"w-3.5 h-3.5 fill-current"})),64))])])]),o.value.provider?.room_id||o.value.buttons?.room_id?(n(),Q(T,{key:0,to:{path:"/profile/chat",query:{roomId:o.value.provider?.room_id||o.value.buttons?.room_id}},class:"flex items-center gap-2 bg-[#EADFD8] text-[#8C6B5D] px-6 py-2.5 rounded-xl hover:bg-[#E0D0C5] transition-colors text-sm font-bold shadow-sm border border-[#DCCAC0]"},{default:M(()=>[b(d(ae),{class:"w-4 h-4"}),e("span",null,s(t.$t("cards.maintenanceDetails.chat")),1)]),_:1},8,["to"])):i("",!0)])])):i("",!0)])]),o.value.buttons?(n(),r("div",vt,[e("div",pt,[o.value.buttons.pay_button?(n(),r("button",{key:0,onClick:q,class:"min-w-[200px] bg-[#bf4e26] text-white py-4 rounded-2xl font-bold text-lg hover:bg-[#a64420] transition-all shadow-lg flex items-center justify-center gap-2"},[N.value?(n(),r("div",_t)):i("",!0),e("span",null,s(t.$t("cards.maintenanceDetails.payNow")),1)])):i("",!0),o.value.buttons.finish?(n(),r("button",{key:1,onClick:I,disabled:f.value,class:"min-w-[200px] bg-[#bf4e26] text-white py-4 rounded-2xl font-bold text-lg hover:bg-[#a64420] transition-all shadow-lg flex items-center justify-center gap-2"},[f.value?(n(),r("div",gt)):i("",!0),e("span",null,s(t.$t("common.finish")),1)],8,xt)):i("",!0),o.value.buttons.cancel?(n(),r("button",{key:2,onClick:L,class:"min-w-[200px] bg-white border-2 border-[#EC2D30] text-[#EC2D30] py-4 rounded-2xl font-bold text-lg hover:bg-red-50 transition-all shadow-lg"},s(t.$t("cards.maintenanceDetails.cancelOrder")),1)):i("",!0),o.value.buttons.rate?(n(),r("button",{key:3,onClick:l[5]||(l[5]=a=>B.value=!0),class:"min-w-[200px] bg-[#bf4e26] text-white py-4 rounded-2xl font-bold text-lg hover:bg-[#a64420] transition-all shadow-lg"},s(t.$t("cards.maintenanceDetails.rate")),1)):i("",!0),o.value.buttons.contact_with_admin?(n(),r("button",wt,s(t.$t("cards.maintenanceDetails.contactWithAdmin")),1)):i("",!0)])])):i("",!0)])):i("",!0),b(H,{visible:m.value,position:"bottom",width:"450px",onClose:l[7]||(l[7]=a=>m.value=!1)},{default:M(()=>[e("div",yt,[e("h3",kt,s(t.$t("cancelModal.title")),1),e("div",$t,[(n(!0),r(w,null,y(g.value,a=>(n(),r("div",{key:a.id,onClick:D=>u.value=a.id,class:U(["flex items-center justify-between p-4 rounded-xl cursor-pointer transition-all border group bg-white/50",u.value===a.id?"border-[#E57373] ring-1 ring-[#E57373]/20":"border-transparent hover:bg-white/80"])},[e("div",Dt,[u.value===a.id?(n(),r("div",jt)):i("",!0)]),e("span",Mt,s(a.name),1)],10,Ct))),128))]),e("div",Et,[e("button",{onClick:O,disabled:!u.value||h.value,class:"w-full bg-[#E57373] text-white py-4 rounded-2xl font-bold text-lg shadow-lg hover:bg-[#d45d5d] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[h.value?(n(),r("div",St)):i("",!0),e("span",null,s(t.$t("cancelModal.confirm")),1)],8,Pt),e("button",{onClick:l[6]||(l[6]=a=>m.value=!1),class:"w-full bg-white text-gray-500 py-4 rounded-2xl font-bold text-lg hover:bg-gray-50 transition-colors border border-gray-100"},s(t.$t("cancelModal.cancel")),1)])])]),_:1},8,["visible"])])}}},Xt=W(At,[["__scopeId","data-v-5bf3f65e"]]);export{Xt as default};
