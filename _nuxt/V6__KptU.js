import{_ as Y}from"./CzoAtjtu.js";import{_ as Z}from"./s-ip-wmu.js";import{a4 as K,H as W,G as X,E as ee,g as te,a0 as se,r as P,u as oe,c as i,o as d,a as s,b as p,C as t,S as re,O as m,J as g,t as l,P as v,T as h,Y as b,Z as ae,F as le,B as ne,d as ie}from"./B0kbPVzu.js";import{c as de,b as _,g as ce,u as ue}from"./Bjc_YOAs.js";import{u as pe}from"./B0CQLlvh.js";import{a as me}from"./UsZkeFBk.js";import{C as ge}from"./BLXiSgHD.js";import{P as he}from"./3GlOfv7A.js";import{L as be}from"./BM_4mnU9.js";import"./Q__ozNUn.js";import"./CzbznNam.js";import"./D_GyIbDE.js";import"./DOS24i9Y.js";import"./D1kvvfSo.js";const fe={class:"min-h-screen bg-gradient-to-br from-[#e8d5cc] to-[#dcb8a8] py-8 px-4 flex flex-col"},ve={class:"container mx-auto"},_e={class:"flex-1 flex items-center justify-center"},ye={class:"bg-white/30 backdrop-blur-md rounded-[3rem] p-8 w-full max-w-2xl shadow-xl border border-white/40"},xe={class:"space-y-2"},qe={class:"block text-right text-[#5d4037] font-bold pr-2"},ke=["placeholder"],we={key:0,class:"text-red-600 text-sm block text-right pr-2"},Re={class:"space-y-2"},$e={class:"block text-right text-[#5d4037] font-bold pr-2"},Pe={class:"relative"},Ee={value:"",disabled:"",selected:""},De=["value"],Ae={class:"absolute left-4 top-1/2 -translate-y-1/2 pointer-events-none text-gray-500"},Ce={key:0,class:"text-red-600 text-sm block text-right pr-2"},Fe={class:"space-y-2"},Be={class:"block text-right text-[#5d4037] font-bold pr-2"},Le=["placeholder"],Se={key:0,class:"text-red-600 text-sm block text-right pr-2"},Ve={class:"space-y-2"},Me={class:"block text-right text-[#5d4037] font-bold pr-2"},Ne=["placeholder"],Ue={class:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none"},ze={class:"border border-gray-500 rounded-full p-0.5"},Ie={key:0,class:"text-red-600 text-sm block text-right pr-2"},Te={class:"space-y-2"},je={class:"block text-right text-[#5d4037] font-bold pr-2"},He=["placeholder"],Ge={key:0,class:"text-red-600 text-sm block text-right pr-2"},Je={class:"pt-4"},Oe=["disabled"],Qe={key:0},Ye={key:1,class:"flex items-center justify-center gap-2"},ut={__name:"request",setup(Ze){const F=K(),B=W(),y=X(),{t:n}=ee(),{success:L,error:E}=pe(),D=F.query.id,S=de({rentPeriod:_().required(n("validation.required")).matches(/^[0-9]+$/,n("validation.numbers_only")||"الأرقام فقط مسموح بها"),quantity:ce().required(n("validation.required")),startDate:_().required(n("validation.required")),location:_().required(n("validation.required")),notes:_().nullable()}),V=te(()=>[{label:n("navigation.home"),to:y("/"),active:!1},{label:n("categories.medicalRental.title"),to:y("/profile/sections/medical-rent"),active:!1},{label:n("categories.medicalRent.request.title"),to:"",active:!0}]),{handleSubmit:M,errors:a,isSubmitting:A,defineField:c,setFieldValue:N,resetForm:U}=ue({validationSchema:S});se(()=>{U({values:{rentPeriod:"",quantity:"",startDate:"",location:"",notes:""}}),u.value=!1,R.value=null,$.value=null});const[f,z]=c("rentPeriod"),[x,I]=c("quantity"),[q,T]=c("startDate"),[k,j]=c("location"),[w,H]=c("notes"),u=P(!1),R=P(null),$=P(null),G=o=>{N("location",o.address),R.value=o.lat,$.value=o.lng,u.value=!1},{post:J}=me(),C=M(async o=>{if(!D){E(n("categories.medicalRent.request.deviceNotFound"));return}try{const e=await J("/orders/create-rent-order",null,{query:{machine_id:D,rent_period:o.rentPeriod,quantity:o.quantity,lat:R.value,lng:$.value,map_desc:o.location,notes:o.notes||""}});if((e==null?void 0:e.key)==="success"||(e==null?void 0:e.status)===200||e!=null&&e.success)L((e==null?void 0:e.msg)||n("categories.medicalRent.request.success")),B.push(y({path:"/profile/orders/rental",query:{tab:"sent"}}));else throw new Error((e==null?void 0:e.msg)||n("categories.medicalRent.request.error"))}catch(e){console.error(e),E(e.error||e.message||n("categories.medicalRent.request.error"))}});return oe({title:n("categories.medicalRent.request.title")}),(o,e)=>{const O=Y,Q=Z;return d(),i("div",fe,[s("div",ve,[p(O,{items:t(V),direction:"ltr"},null,8,["items"])]),s("div",_e,[s("div",ye,[s("form",{onSubmit:e[7]||(e[7]=re((...r)=>t(C)&&t(C)(...r),["prevent"])),class:"space-y-6"},[s("div",xe,[s("label",qe,l(o.$t("categories.medicalRent.request.rentPeriod")),1),m(s("input",h({"onUpdate:modelValue":e[0]||(e[0]=r=>b(f)?f.value=r:null)},t(z),{onInput:e[1]||(e[1]=r=>{f.value=r.target.value.replace(/\D/g,"")}),type:"text",placeholder:o.$t("categories.medicalRent.request.rentPeriod"),class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none",{"ring-2 ring-red-500/50":t(a).rentPeriod}]}),null,16,ke),[[v,t(f)]]),t(a).rentPeriod?(d(),i("span",we,l(t(a).rentPeriod),1)):g("",!0)]),s("div",Re,[s("label",$e,l(o.$t("categories.medicalRent.request.quantity")),1),s("div",Pe,[m(s("select",h({"onUpdate:modelValue":e[2]||(e[2]=r=>b(x)?x.value=r:null)},t(I),{class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none appearance-none text-[#5d4037]",{"ring-2 ring-red-500/50":t(a).quantity}]}),[s("option",Ee,l(o.$t("categories.medicalRent.request.selectQuantity")),1),(d(),i(le,null,ne(10,r=>s("option",{key:r,value:r},l(r),9,De)),64))],16),[[ae,t(x)]]),s("div",Ae,[p(t(ge),{size:"20"})])]),t(a).quantity?(d(),i("span",Ce,l(t(a).quantity),1)):g("",!0)]),s("div",Fe,[s("label",Be,l(o.$t("categories.medicalRent.request.startDate")),1),m(s("input",h({"onUpdate:modelValue":e[3]||(e[3]=r=>b(q)?q.value=r:null)},t(T),{type:"date",placeholder:o.$t("categories.medicalRent.request.startDate"),class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none block",{"ring-2 ring-red-500/50":t(a).startDate}]}),null,16,Le),[[v,t(q)]]),t(a).startDate?(d(),i("span",Se,l(t(a).startDate),1)):g("",!0)]),s("div",Ve,[s("label",Me,l(o.$t("categories.medicalRent.request.deviceLocation")),1),s("div",{class:"relative cursor-pointer",onClick:e[5]||(e[5]=r=>u.value=!0)},[m(s("input",h({"onUpdate:modelValue":e[4]||(e[4]=r=>b(k)?k.value=r:null)},t(j),{type:"text",readonly:"",placeholder:o.$t("categories.medicalRent.request.deviceLocation"),class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 pl-12 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none cursor-pointer",{"ring-2 ring-red-500/50":t(a).location}]}),null,16,Ne),[[v,t(k)]]),s("div",Ue,[s("div",ze,[p(t(he),{size:"14"})])])]),t(a).location?(d(),i("span",Ie,l(t(a).location),1)):g("",!0)]),s("div",Te,[s("label",je,l(o.$t("categories.medicalRent.request.notes")),1),m(s("textarea",h({"onUpdate:modelValue":e[6]||(e[6]=r=>b(w)?w.value=r:null)},t(H),{rows:"4",placeholder:o.$t("categories.medicalRent.request.notes"),class:["w-full bg-[#F5EBE0]/80 border-0 rounded-xl py-4 px-6 text-right placeholder-gray-400 focus:ring-2 focus:ring-[#A63C12]/50 outline-none resize-none",{"ring-2 ring-red-500/50":t(a).notes}]}),null,16,He),[[v,t(w)]]),t(a).notes?(d(),i("span",Ge,l(t(a).notes),1)):g("",!0)]),s("div",Je,[s("button",{type:"submit",disabled:t(A),class:"w-full bg-gradient-to-r from-[#A63C12] to-[#8F300E] text-white font-bold py-4 rounded-xl shadow-lg hover:shadow-xl transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed"},[t(A)?(d(),i("span",Ye,[ie(l(o.$t("categories.medicalRent.request.sending"))+" ",1),p(t(be),{class:"animate-spin",size:"20"})])):(d(),i("span",Qe,l(o.$t("categories.medicalRent.request.send")),1))],8,Oe)])],32)])]),p(Q,{"is-open":t(u),onClose:e[8]||(e[8]=r=>u.value=!1),onLocationSelected:G},null,8,["is-open"])])}}};export{ut as default};
